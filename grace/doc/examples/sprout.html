<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
<style type="text/css" media="all">
span.string  {color: #bc8f8f;} 
span.output  {color: #bc8f8f;} 
span.comment {color: #b22222;}  
span.keyword {color: #da70d6;} 
span.reserved {color: #a020f0;}
span.classof {color: #228b22;}
span.command {color: #0000ff;}
span.constant {color: #5f9ea0;}
pre.salcode{}
</style>
<title>sprout.html</title>
</head>
<body>
<p><span style="font-size:large;">Download source: <a href="/Lisp/grace/doc/examples/sprout.sal">
<img src="fileicon.png" style="border:none;" alt="[fileicon.png]" /> sprout.sal</a></span></p>
<hr/><pre class="salcode">
<span class="comment">;; Sprouting processes</span>

<span class="command">define</span> <span class="classof">process</span> pinkscale(len, scale)
  <span class="comment">;; map pink noise onto a scale</span>
  <span class="reserved">run</span> <span class="reserved">repeat</span> len
    <span class="reserved">send</span> <span class="string">"mp:midi"</span>, <span class="keyword">key:</span> discrete( ranpink(), -1, 1, scale)
    <span class="reserved">wait</span> .125
  <span class="reserved">end</span>

<span class="command">define</span> <span class="classof">variable</span> dorian = scale(50, 20, 2, 1, 2, 2, 2, 1, 2)

<span class="command">sprout</span> pinkscale(60, dorian)

<span class="comment">;; sprouting more than one process at a time</span>

<span class="command">define</span> <span class="classof">process</span> piano-phase (stop, keys, rate)
  <span class="reserved">run</span> <span class="reserved">with</span> pat = make-cycle(keys)
    <span class="reserved">until</span> elapsed() &gt;= stop
    <span class="reserved">send</span> <span class="string">"mp:midi"</span>, <span class="keyword">key:</span> next(pat), <span class="keyword">dur:</span> rate
    <span class="reserved">wait</span> rate
  <span class="reserved">end</span>

<span class="command">begin</span>
  <span class="reserved">with</span> trope = {e4 fs4 b4 cs5 d5 fs4 e4 cs5 b4 fs4 d5 cs5} ,
       nsecs = 20
  <span class="reserved">sprout</span> list( piano-phase(nsecs, key(trope), .167),
               piano-phase(nsecs, key(trope), .17))
<span class="command">end</span>

<span class="comment">;; Using ids to selectively stop processes</span>

<span class="command">define</span> <span class="classof">process</span> chopin (n, r, d, k)
  <span class="reserved">run</span> <span class="reserved">repeat</span> n
    <span class="reserved">send</span> <span class="string">"mp:midi"</span>, <span class="keyword">dur:</span> d, <span class="keyword">key:</span> k
    <span class="reserved">wait</span> r
  <span class="reserved">end</span>

<span class="comment">;; sprout D# minor chord with ids</span>

<span class="command">begin</span>
  <span class="reserved">sprout</span> chopin(50, .5, .25, 63), 0, 1
  <span class="reserved">sprout</span> chopin(50, .5, .25, 66), 0, 2
  <span class="reserved">sprout</span> chopin(50, .5, .25, 70), 0, 3
  <span class="reserved">sprout</span> chopin(50, .5, .25, 75), 0, 1
<span class="command">end</span>

<span class="comment">;; stop F#</span>
<span class="command">exec</span> stop(2)

<span class="comment">;; stop A#:</span>
<span class="command">exec</span> stop(3)

<span class="comment">;; stop D# octave:</span>
<span class="command">exec</span> stop(3)

</pre>
</pre>
<hr/>
<div style="float:left;"><p>Generated by <em>sal2html</em> Sat Apr 26 08:08:10 2008</p></div><div style="float:right;"><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10-blue" style="border:none;" alt="Valid XHTML 1.0 Strict" height="31" width="88"/></a></div>
</body>
</html>
