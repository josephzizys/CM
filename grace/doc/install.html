<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html
xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> <head>
<meta http-equiv="content-type" content="text/html;
charset=iso-8859-1"/> <style type="text/css" media="all"> @import
"grace.css"; </style> <title>The Console Window</title> </head> <body>
<div id="content">

<h1>Installing and Running Grace</h1>

  <ul>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#svn">Downloading Sources (SVN) </a></li>
    <li><a href="#compiling">Compiling Sources</a>
    <ul>
      <li> <a href="#compile_scheme">Compiling Grace with Scheme</a></li>
      <li> <a href="#compile_cl">Compiling Grace with Common Lisp</a></li>
      </ul>
      </li>
    <li><a href="#installing">Installing the Application</a></li>
    <li><a href="#running">Running Grace</a>
    <ul>
    <li><a href="#scheme">Grace with Scheme</a></li>
    <li><a href="#cl"> Grace with Common Lisp</a></li>
    <li><a href="#starting">Starting Grace from the Command Line</a></li>
    <li><a href="#options">Command Line Options</a></li>
    </ul>
    </li>
    <li><a href="#appendix">Appendix</a>
    <ul>
      <li><a href="#juce">Installing JUCE</a>
      <ul>
	<li><a href="#juce_linux">Installing JUCE on Linux</a></li>
	<li><a href="#juce_osx">Installing JUCE on OS X</a></li>
      </ul>
      </li>
      <li><a href="#chicken">Installing Chicken Scheme</a></li>
      <!-- li><a href="#building_binary">Building a binary release of Grace</a></li -->
    </ul>
</li>
</ul>
<!-- h2 id="binary_installation">Binary Installation</h2>
<p><em>  Not written. </em></p -->


<h2 id="requirements">Requirements</h2>

<p>Installing Grace from its sources requires the following software systems:</p>

<ul>
  <li><a href="http://subversion.tigris.org/">Subversion</a></li>
  <li><a href="http://www.scons.org/">SCons</a></li>
  <li><a href="http://www.rawmaterialsoftware.com/juce/">JUCE</a> </li>
  <li><a href="http://www.call-with-current-continuation.org/">Chicken Scheme</a> if you are building Grace with real time scheduling.</li>
  <li><a href="http://sbcl.sourceforge.net/platform-table.html">SBCL</a> or <a href="http://sourceforge.net/project/showfiles.php?group_id=1355">CLisp</a> if you are building Grace with Common Lisp (Common Music, CLM, etc)</li>
</ul>

<h2 id="svn">Downloading Sources (SVN)</h2> <p>Use
<code>svn</code> to download the Grace source tree. Use your favorite
SVN client or type the following command in the Terminal (all on one
line): </p>

<blockquote>
<pre class="code">
$ svn co http://commonmusic.svn.sf.net/svnroot/commonmusic/trunk/grace grace</pre>
</blockquote>

<h2 id="compiling">Compiling Sources</h2>

<p>Before you attempt to compile the sources to Grace you must have
JUCE installed on your machine. See <a href="#juce">Installing JUCE</a>
for more information.</p>

<p>Grace can be built to run either Chicken Scheme or Common Lisp as
its extension language.</p>

<h3 id="compile_scheme">Compiling Grace with Scheme</h3>

<p>To compile Grace with Chicken Scheme you must have Chicken Scheme
installed on your machine. See <a href="#chicken">Installing Chicken
Scheme</a> for more information.</p>

<blockquote>
<pre class="code">
$ cd /path/to/grace
$ scons JUCEDIR=/path/to/jucedir SCHEME=1
</pre>
</blockquote>

<h3 id="compile_cl">Compiling Grace with Common Lisp</h3>
<p>To compile Grace to use with Common Lisp do:</p>

<blockquote>
<pre class="code">
$ cd /path/to/grace
$ scons JUCEDIR=/path/to/jucedir
</pre>
</blockquote>
  
<p>If you are successful the compiled files and executable will be in grace/build.</p>

<h2 id="installing">Installing the Application</h2>

<p>Once you have compiled Grace you can install the run-time (executable, documentation and run-time support) on your system like this:</p>

<blockquote>
  <pre class="code">$ scons install</pre>
</blockquote>

<p>On OSX the installation paths are:</p>

<ul>
  <li>executable:	build/Grace.app/Contents/MacOS/grace</li>
  <li>resource dir:	build/Grace.app/Contents/Resources/*</li>
</ul>

<p>
On Linux the installation paths are:
</p>

<ul>
  <li>executable:          build/bin/grace</li>
  <li>resource dir:	build/lib/grace/*</li>
</ul>
   
<p>
On Windows the installation paths are:
</p>

<ul>
  <li>executable:	/build/Grace/grace.exe</li>
  <li>resource dir:	/build/Grace/Resources/*</li>
</ul>

<p> The resource directory contains Grace's run-time Lisp code, help
files, tutorials, etc.  On OS X and Windows the resource directory is
bundled together with the executable so once you have done 'scons
install' you can move the application bundle anywhere, e.g. into your
/Applications folder on the Mac or your C:\Program Files\ directory on
Windows. On Linux you can move the contents of build/bin and build/lib
to under /usr/local like this:</p>

<blockquote>
  <pre class="code"> $ sudo "(cd build &amp;&amp; tar -cf - bin lib) | (cd /usr/local &amp;&amp; tar -xvf -)" </pre>
</blockquote>

<p>If you are building Grace to use with Common Lisp you can install CM (and any other Lisp systems you want to work with) under the resource directory so that all your Lisp run-time will be located under a common parent directory. The resource directory will become the default Lisp site directory when Grace starts up.</p>

<blockquote>
<pre class="code">
$ cd /path/to/grace/resources/
$ svn co https://commonmusic.svn.sf.net/svnroot/commonmusic/trunk/cm cm</pre>
</blockquote>

<h2 id="running">Running Grace </h2>

<p>Grace can run either Scheme or Common Lisp as its extension language.</p>
<ul>
<li>Grace with Scheme provides a cross-platform, real-time algorithmic composition environment. It is roughly equivalent to Emacs+Slime+CM+RTS+Portmidi. See <a href="scheme.html">Grace with Scheme</a> for more information.</li>
<li>Grace with Common Lisp is a cross-platform environment for working with Lisp systems like Common Music, CLM, CMN, Fomus, etc. It is roughly equivalent to Emacs+Slime+CM+CLM+Fomus</li>
</ul>

<h3 id="scheme">Running Grace with Scheme </h3>

<p>The Chicken Scheme library (libchicken) is loaded automatically when
Grace starts up. If Grace starts without any errors then Scheme is
running and you don't need to do anything else. If your Linux is too
retarded to look in /usr/local/lib for libraries, you can tell it to do so
with a line like this in your ~/.bash_profile (or whatever init script
is appropriate):</p>

<blockquote>
<pre class="code">export LD_LIBRARY_PATH=/usr/local/lib</pre>
</blockquote>

<p>Alternately you can make a link to the library like this:</p>

<blockquote>
<pre class="code">sudo ln -s /usr/local/lib/libchicken.so /usr/lib/libchicken.so</pre>
</blockquote>

<h3 id="cl">Running Grace with Common Lisp (Grace CL)</h3>

<p> To run Grace with Common Lisp you must have a recent version of
<a href="http://sbcl.sourceforge.net/platform-table.html">SBCL</a> or <a href="http://sourceforge.net/project/showfiles.php?group_id=1355">Clisp</a> installed on your machine. </p>

<p>Use <span class="menuitem">Console&gt;Lisp&gt;Configure
Lisp...</span> to configure your Lisp session profile.  </p>


<p> Select <span class="menuitem">Console&gt;Lisp&gt;Start Lisp</span>
to start a configured Lisp session.</p>

<p>Grace normally looks for Lisp software systems under its 'ASDF
systems directory'. The first time Grace starts up it sets the ASDF
systems directory to be the same as the Resource directory.  You can
change this path using the <span
class="menuitem">Console&gt;Lisp&gt;Configure Lisp...</span>
dialog.</p>

<p>To evaluate code, open use <span
class="menuitem">Console&gt;File&gt;New</span> to open an Editor
window. Then type code to evaluate in the buffer and press <span
class="emacscmd">COMMAND-Return</span> to send an expression to
Lisp. Evaluation output appears in the Console window.</p>

<p> See <span class="menuitem">Console&gt;Help</span> and <span
class="menuitem">Editor&gt;Help</span> for more information about this
process.</p>


<h3 id="starting">Starting Grace from the Command Line</h3>

<p>You normally start Grace by simply double-clicking its icon but it
is also possible to start Grace from the command line.  Starting Grace
from the command line allows you to command line arguments to the app
and also makes debugging information visible in the Terminal.</p>

<p>To start the application from the terminal on Linux type: </p>

<blockquote>
<pre class="code">$ grace &amp;</pre>
</blockquote>

<p> To start the application from the terminal on OS X type: </p>

<blockquote>
<pre class="code">$ exec /Applications/Grace.app/Contents/MacOS/Grace &amp;</pre>
</blockquote>

<h3 id="options">Command Line Options</h3>

<p>Grace supports the following command line options. Command options override values stored in the preferences file.</p>
<dl>
  <dt><code>--no-prefs</code></dt>
  <dd> Tells Grace to not load your preferences file. Starts the application with its release configuration.</dd>
  <dt><code>--resource-directory</code> <var>directory</var></dt>
  <dd> Specifies a (non-default) location for the application resource directory.</dd>
  <dt><code>--asdf-systems-directory</code> <var>directory</var></dt>
  <dd> Specifies the location of the ASDF system directory.</dd>
  <dt><code>--clisp-program</code> <var>path</var></dt>
  <dd> The full pathname to your CLISP executable. </dd>
  <dt><code>--sbcl-program</code> <var>path</var></dt>
  <dd> The full pathname to your SBCL executable. </dd>
  <dt><code>--scheme-heap-size</code> <var>number</var></dt>
  <dd> The initial size of Scheme's heap. </dd>
  <dt><code>--scheme-stack-size</code> <var>number</var></dt>
  <dd> The initial size of Scheme's stack. </dd>
  </dl>

<h2 id="appendix">Appendix</h2>

<h3 id="juce">Installing JUCE</h3>

<p>Installing JUCE is straightforward, the biggest issue is making
sure you disable UNICODE support (everywhere), OpenGL support unless
you have the OpenGL libraries installed and (on Linux) disabling Xinerama support you don't use it.</p>


<h3 id="juce_linux">Installing JUCE on Linux</h3>

<ol>
  <li>
  <p>
  Edit the file juce/juce_Config.h.
  </p>

  <p> Turn Unicode support OFF by  setting JUCE_STRINGS_ARE_UNICODE to 0:</p>
  <pre class="code">
#ifndef JUCE_STRINGS_ARE_UNICODE
  #define JUCE_STRINGS_ARE_UNICODE 0 
#endif</pre>

  <p>[Strictly speaking you don't have to do this but if you don't the
  text editor will be too slow for anything but the smallest files.]
  </p>

  <p>
  Turn OFF OpenGL support unless you have the OpenGL libraries installed:
  </p>
  <pre class="code">#ifndef JUCE_OPENGL
  #define JUCE_OPENGL 0
#endif</pre>

  <p> Turn OFF Xinerama (multi-monitor lib) unless you are using
  it. (If so you will have to add it to the linking set): </p>

  <pre class="code">#ifndef JUCE_USE_XINERAMA
  #define JUCE_USE_XINERAMA 0
#endif</pre>
  </li>

  <li>
  <p>
  Make the Release version of libjuce.a:
  </p>

  <pre class="code">
$ cd juce/build/linux
$ make CONFIG=Release</pre>

 </li>
</ol>
 
<p>If you are successful the JUCE library will be saved in juce/bin/libjuce.a.
</p>


<h3 id="juce_osx">Installing JUCE on OSX</h3>

<ol>
  <li>

<p> Edit the file juce/juce_Config.h and turn Unicode support OFF by
setting JUCE_STRINGS_ARE_UNICODE to 0: </p>

<pre class="code">  
#ifndef JUCE_STRINGS_ARE_UNICODE
  #define JUCE_STRINGS_ARE_UNICODE 0 
#endif
</pre>
<p>

[Strictly speaking you don't have to do this but if you don't the text
 editor will be too slow for anything but the smallest files.]
</p>

<p>
  Turn OFF OpenGL support unless you have the OpenGL libraries installed:
</p>
  <pre class="code">
  #ifndef JUCE_OPENGL
  #define JUCE_OPENGL 0
#endif</pre>
  </li>

<li>
  <p> Edit the file juce/build/macosx/juce.xcconfig and make sure
  XCODE is using an appropriate SDK for your machine. Your SDKs are
  located under /Developer/SDKs/. This is the contents of my
  juce.xcconfig that I complied on a 10.4 PPC machine: </p>

<pre class="code">
ARCHS = ppc i386
SDKROOT = /Developer/SDKs/MacOSX10.4u.sdk
GCC_VERSION_ppc = 3.3
MACOSX_DEPLOYMENT_TARGET_ppc = 10.4
OTHER_LD_FLAGS_ppc = /Developer/SDKs/MacOSX10.4u.sdk/usr/lib/gcc/darwin/3.3/libstdc++.a
SDKROOT_ppc = /Developer/SDKs/MacOSX10.4u.sdk</pre>

</li>  

<li>
<p> Open the JUCE Xcode project in juce/build/macosx/Juce.xcodeproj
and select <span class="menuitem">Project&gt;Set Active Build Configuration&gt;Release</span>.  Then
press the Build icon.  If you are successful the JUCE library will be
saved in juce/bin/libjuce.a.  </p>
</li>
</ol>

<h3 id="chicken">Installing Chicken Scheme</h3>
<p>To build libchicken  download the latest release of  <a href = "http://chicken.wiki.br/releases">Chicken Scheme</a> and then compile and install it. Type just  'make'
 inside the chicken directory to get the list of supported platforms.</p>

<blockquote>
<pre class="code">$ tar -zxf chickentar.gz
$ cd chicken
$ make
$ make PLATFORM=macosx
$ sudo make PLATFORM=macosx install</pre>
</blockquote>

<p>That will compile chicken and install its commands (csi, csc) and
library (libchicken) on your system. (If you are on Linux then you may
also have to copy libchicken.so to /usr/bin if Grace can't find it
when it starts up...)</p>


<!--

<h3 id="building_binary">Building a Binary Installation of Grace</h3>
<p>How to make a relocatable, binary install of Grace. (Documented here mainly so I don't forget how to do it!)</p>
<ol>
  <li>First build and install Grace from sources as usual:
  <pre>$ scons JUCEDIR=/path/to/juce
$ scons install
</pre>
  </li>
  <li>Change directories to the Grace resource directory (Windows=build/Grace/Resources, OSX=build/Grace.app/Contents/Resources, Linux=/usr/local/lib/grace) and install the lisp sources for cm, Fomus and whatever other Lisp systems you want to include with the app:<pre>$ cd build/Grace.app/Contents/Resources
$ svn co http://commonmusic.svn.sf.net/svnroot/commonmusic/trunk/cm cm  
$ svn co svn://common-lisp.net/project/fomus/svn/fomus/trunk fomus
</pre>  
</li>
<li>Optional: Install CLISP or SBCL under the Resource dir (see below).</li>
</ol>
-->

</div>
<hr/>
<p>
<!-- hhmts start --> Last modified: Wed Jan  9 13:40:29 CST 2008 <!-- hhmts end -->
</p>
</body>
</html>
