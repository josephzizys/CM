<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
<style type="text/css" media="all">
@import "../css/cm.css";
span.string  {color: #bc8f8f;} 
span.output  {color: #bc8f8f;} 
span.comment {color: #b22222;}  
span.keyword {color: #da70d6;} 
span.special {color: #a020f0;}
span.classof {color: #228b22;}
span.command {color: #0000ff;}
span.constant {color: #5f9ea0;}
code.keyword {color: #da70d6;}
</style>
<title>SAL</title>
</head>
<body>
<div id="content">

<dl class="dictsyntax">
<dt>[Topic]</dt>
<dd>SAL</dd>
</dl>

<!-- h2>Introduction</h4 -->

<h2>Contents</h2>
<ol>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#commands">Commands</a></li>
  <li><a href="#statements">Statements</a></li>
  <li><a href="#sexprs">Symbolic expressions</a></li>
  <li><a href="#reserved">Reserved words</a></li>
  <li><a href="#lacunae">Lacun&aelig;</a></li>
</ol>

<h2 id="introduction">Introduction</h2>

<p> SAL is an <a
href="http://en.wikipedia.org/wiki/Infix_notation">infix</a> syntax
for working with Common Music. It provides an easy-to-learn,
command-based language that does not require any familiarity with Lisp
to work with.  The name SAL stands for Simple Algorithmic Language (or
Secretly Another Lisp, as you wish) and is a <em>hommage</em> to <a
href="http://ems.music.uiuc.edu/~martiran/">Sal Martirano</a>, a
brilliant and influential composer who was a professor at the UIUC
School of Music for many years. </p>

<p> The SAL system consists of two software components: a lexer/parser
that is loaded into Common Music <!--(using <a
href="use-system-fn.html">use-system</a>) --> and an Emacs mode
(<code>sal-mode</code>) that supports editing and executing SAL
programs. <!-- Sal's lexer and parser often do a better job explaining
syntax errors than the underlying Lisp error system and (by default)
runtime errors are reported without entering the Lisp error break. -->

<p> A SAL program consists of <var>commands</var>,
<var>statements</var> and <var>symbolic expressions</var>.  A command
is a "top-level" statement that is <var>executed</var> to accomplish a
task such as triggering output, defining functions and musical
processes, loading files, and so on. A statement is a construct in the
SAL language, such as <code>set</code>, <code>loop</code>,
<code>define</code>, etc.  A symbolic expression , or <var>sexpr</var>
is something that evaluates to a value.
</p>

<!--
<p>
By way of introduction, here are some equivalent statements in SAL
and Lisp syntax:
</p>

<blockquote>
<table>

<tr><td style="padding-right: 1em; vertical-align: top;">SAL:</td> <td><pre><span class="salcmd">print</span> 1 + 2</code></td></tr>
<tr><td style="padding-right: 1em; vertical-align: top;">Lisp:</td> <td><pre>(print (+ 1 2))</pre></td></tr>
  


<tr> <td style="padding-right: 1em; vertical-align: top;">SAL:</td><td><pre>
<span class="salcmd">set</span> a = {1 2 3}, b += 2</pre></td></tr>

<tr> <td style="padding-right: 1em; vertical-align: top;">Lisp:</td><td>
<pre>(progn (setf a '(1 2 3)) (incf b 2))</pre></td></tr>


<tr> <td style="padding-right: 1em; vertical-align: top;">SAL:</td><td style="vertical-align: top;"><pre><span class="salcmd">loop</span> <span class="salres">for</span> i <span class="salres">to</span> 12
  <span class="salres">print</span> 2 ^ (i / 12)
<span class="salcmd">end</pre></pre></td><tr>

<tr> <td style="padding-right: 1em; vertical-align: top;">Lisp:</td><td>
<pre>(loop for i below 12
  do (print (expt 2 (/ i 12))))</pre></td><tr>

</table>
</blockquote>

<p><var>Statements:</var></p>

<blockquote>
<table>


</table>

  <tr><td style="padding-right: 1em; vertical-align: top;">SAL:</td> <td><pre><span class="salcmd">print</span> list(1, 2 + 3, random(4))</pre></td></tr>

<tr><td style="padding-right: 1em; vertical-align: top;">SAL:</td> <td><pre>(print (list (+ 1 2) 3 (random 4))</pre></td></tr>

</blockquote>

<p><var>Global variable definition:</var></p>

<blockquote>
<table>
<tr> <td style="padding-right: 1em; vertical-align: top;">SAL:</td><td ><code><span class="salcmd">define</span> <span class="saltyp">variable</span> 2pi = 2 * pi</code></td></tr>
<tr> <td style="padding-right: 1em; vertical-align: top;">Lisp:</td> <td><code>(defparameter 2pi (* 2 pi))</code></td></tr>
</table>
</blockquote>

<p><var>Variable assignment:</var></p>

<blockquote>
<table>
<tr> <td style="padding-right: 1em; vertical-align: top;">SAL:</td><td>
<code><span class="salcmd">set</span> a = random(127), b += 2, c &amp;= b, m.keynum = a</code></td></tr>
<tr> <td style="padding-right: 1em; vertical-align: top;">Lisp:</td><td>
<code>(setf a (random 127) b (+ b 2) c (nconc c (list b)) (slot-value m 'keynum) a)</code></td></tr>
</table>
</blockquote>


<p><var>Function definition:</var></p>

<blockquote>
<table>
<tr> <td style="padding-right: 1em; vertical-align: top;">SAL:</td><td>
<pre><span class="salcmd">define</span> <span class="saltyp">function</span> rankey (low, high)
  <span class="salres">begin</span>
    <span class="salres">with</span> range = high - low
    <span class="salres">return</span> low + random(range)
  <span class="salres">end</span></pre></td></tr>
<tr> <td style="padding-right: 1em; vertical-align: top;">Lisp:</td><td>
<pre>(defun rankey (low high)
  (let ((range (- high low)))
    (+ low (random range))))</pre></td></tr>
</table>
</blockquote>

<p><var>Musical process definition:</var></p>

<blockquote>
<table>
<tr> <td style="padding-right: 1em; vertical-align: top;">SAL:</td><td>
<pre><span class="salcmd">define</span> <span class="saltyp">process</span> foo (n, r)
  <span class="salres">run</span> <span class="salres">repeat</span> n
    <span class="salres">for</span> k = rankey(60, 80)
    <span class="salres">output</span> <span class="special">#a</span>[<span class="saltyp">midi</span> <span class="keyword">time:</span> now() <span class="keyword">keynum:</span> k]
    <span class="salres">wait</span> r
  <span class="salres">end</span></pre></td></tr>

  <tr><td style="padding-right: 1em; vertical-align: top;">Lisp:</td>
    <td > <pre>(defun foo (n r)
  (process repeat n
           for k = (rankey 60 80)
           output (new midi :time (now) :keynum k)
           wait r))</pre></td></tr>
</table>
</blockquote>

-->

<h2 id="commands">SAL Mode</h2>

<p>SAL mode is an Emacs editing mode that provides a SAL edit menu, syntax highlighting and evaluation services for SAL programs.

<h3>The SAL menu</h3>


<table style="background: #eeeeee; border: 1px solid darkgray">
  <tr><td><a href="#start_cm">Start CM</a></td></tr>
  <tr><td style="border-bottom: 1px solid darkgray;"><a href="#show_repl">Show REPL</a></td></tr>
  <tr><td ><a href="#execute">Execute</td></tr>
  <tr><td style="border-bottom: 1px solid darkgray;"> <a href="#trace">&radic;  Trace</a></td></tr>
  <tr><td><a href="#use_system">Use System</a> </td></tr>
  <tr><td><a href="#show_directory">Show Directory</a></td></tr>
  <tr><td><a href="#set_directory">Set Directory...</a></td></tr>
  <tr><td><a href="#load_file">Load File...</a></td></tr>
  <tr><td style="color:silver;"><a href="#comile_file">Compile File...</a></td></tr>
  <tr><td style="color:silver;"><a href="#import_file">Import File...</a></td></tr>
  <tr><td style="border-bottom: 1px solid darkgray;"><a href="#import_file">Play File...</a></td></tr>
 <tr><td><a href="#help">Help</a></td></tr>
</table>
</blockquote>

<dl>
  <dt id="start_cm">Start CM</dt>  <dd>Start/Kill a Common Music session.</dd>
  <dt id="show_repl">Show REPL</dt>  <dd>Makes REPL window visible on screen.</dd>
  <dt id="execute">Execute</dt>  <dd>Execute SAL command before point.</dd>
  <dt id="trace">Trace</dt>  <dd>Toggle tracing (debugging).</dd>
  <dt id="use_system">Use System</dt> <dd>Submenu for loading software systems.</dd>
  <dt id="show_directory">Show Directory</dt>  <dd>Shows current working directory.</dd>
  <dt id="set_directory">Set Directory...</dt>  <dd>Pop-up dialog sets working directory.</dd>
  <dt id="load_file">Load File...</dt>  <dd>Pop-up dialog loads SAL or Lisp file.</dd>
  <dt id="compile_file">Compile File...</dt>  <dd>Not yet implemented.</dd>
  <dt id="import_file">Import File...</dt>  <dd>Not yet implemented.</dd>
  <dt id="play_file">Play File...</dt>  <dd>Pop-up dialog plays MIDI or audio files.</dd>
  <dt id="help">Help</dt>  <dd>Submenu of Help commands</dd>
</dl>

<h3>Syntax Highlighting</h3>
<p>Sal mode colorizes program text in the following way:</p>

<ul>
  <li>Comments are <span class="salcom">red</span>
  <li>Strings are <span class="salstr">tan</span></li>
  <li>Commands are  <span class="salcmd">blue</span> </li>
  <li>Reserved words are <span class="salres">purple</span></li>
  <li>Class names are <span class="saltyp">green</span></li>
  <li>Named parameters are  <span class="salkey">pink</span></li>
  <li>Special notations are  <span class="salcon">aqua</span></li>
</ul>


<h3>Evaluation Services</h3>


<p>To evaluate a SAL command, place the cursor at the end of the statement and press Enter on the keypad. Any print out associated with the command will appear in the Lisp REPL window.</p>



<!-- COMMANDS -->


<h2 id="commands">Commands</h2>

<p>Commands are "top-level" statements that can be directly executed
from an Emacs buffer in <code>sal-mode</code>. To execute a Sal
command use the SAL menu to start a Sal session, then place the cursor
after the command expression and press the keypad Enter key.</p>


<dl class="dictsyntax" id="chdir">
<dt>[Command]</dt>
<dd><code class="entry">chdir</code> [<var>dir</var>]</dd>
</dl>

<p> Change the working directory to <var>dir</var>. If <var>dir</var>
is not provided it defaults to the user's home directory. Otherwise
the value of <var>dir</var> should be a directory string or variable
containing a directory string.</p>

<span id="define"></span>

<dl class="dictsyntax"  id="define_variable">
<dt>[Command]</dt>
<dd><code class="entry">define variable</code> <var>name</var> [<code class="entry">=</code> <var>sexpr</var>] {<code class="entry">,</code> <var>name</var> [<code class="entry">=</code> <var>sexpr</var>]}*</dd>
</dl>

<p> Defines a global variable <var>name</var> with optional value <var>sexpr</var>. If <var>sexpr</var> is not provided the value of the variable defaults to false. Use commas to define more than one variable at a time. </p>

<h4>Example</h4>

<div class="float">
<pre class="code">
<span class="salcmd">define</span> <span class="saltyp">variable</span> myrow = {0 1 11 2 10 3 9 4 8 5 7 6}
</pre>
</div>


<dl class="dictsyntax" id="define_function">
<dt>[Command]</dt>
<dd><code class="entry">define function</code> <var>name</var> <code>(</code>[<var>parameter</var>] {<code class="entry">,</code> <var>parameter</var>}*<code>)</code> {<var>statement</var>}</dd>
</dl>

<p>A function definition consists of the <var>name</var> of the function, a series of zero or more <var>parameters</var>, or input variables, enclosed within <code>()</code> and followed by a single statement which will be executed when the function is called. Values passed to the function will be available in the corresponding <var>parameter</var>. Use a <a href="#begin"><code>begin</code></a> block to declare local variables or to include more than one statement in the body of the function. Use the <a href="#return"><code>return</code></a> statement to return one or more values from a function. A function without a <a href="#return"><code>return</code></a> statement returns nothing as its value.</p>

<h4>Example</h4>
<div class="float">
<pre class="code">
<span class="comment">; pitch class transposition of a row </span>

<span class="salcmd">define</span> <span class="saltyp">function</span> pctransp(row, pc)
  <span class="salres">loop</span> <span class="salres">with</span> l = list()
    <span class="salres">for</span> i <span class="salres">in</span> row
    <span class="salres">set</span> l &amp;= mod( i + pc, 12)
    <span class="salres">finally</span> <span class="salres">return</span> l
  <span class="salres">end</span>

<span class="comment">; pc inversion of a row </span>

<span class="salcmd">define</span> <span class="saltyp">function</span> pcinvert(row)
  <span class="salres">loop</span> <span class="salres">with</span> l = list()
    <span class="salres">for</span> i <span class="salres">in</span> row
    <span class="salres">set</span> l &amp;= mod( - i, 12)
    <span class="salres">finally</span> <span class="salres">return</span> l
  <span class="salres">end</span>

<span class="comment">; compute the matrix of a row</span>

<span class="salcmd">define</span> <span class="saltyp">function</span> matrix(row)
  <span class="salres">loop</span> <span class="salres">with</span> mat = list(), inv = pcinvert(row)
    <span class="salres">for</span> i <span class="salres">in</span> inv
    <span class="salres">for</span> new = pctransp(row, i)
    <span class="salres">set</span> mat &amp;= new
    <span class="salres">finally</span> <span class="salres">return</span> mat
  <span class="salres">end</span>

<span class="salcmd">print</span> matrix(myrow)
</pre>
</div>

<dl class="dictsyntax" id="define_process">
<dt>[Command]</dt>
<dd><code class="entry">define process</code> <var>name</var> <code>(</code>[<var>parameter</var>] {<code class="entry">,</code> <var>parameter</var>}*<code>)</code> {<var>statement</var>}</dd>
</dl>

<p> Musical process definitions are very similar to functions except that they do not have
<a href="#return"><code>return</code></a> statements and they must contain a <a href="#run"><code>run</code></a> block as their final statement. The <code>run</code> block is syntactically identical to the  <a href="#run"><code>loop</code></a> statement except that it supports several additional statements that are specific to musical process definitions, for example <a href="#output"><code>output</code></a> and <a href="#wait"><code>wait</code></a>.
<!-- Use <a href="#output"><code>output</code></a> statements inside the <code>run</code> block to send musical object to an <a href="#open">open output stream</a> on each iteration.</p> -->

<h4>Example</h4>
<div class="float">
<pre class="code">
<span class="salcmd">define</span> <span class="saltyp">process</span> foo(n, r)
  <span class="salres">run</span> <span class="salres">repeat</span> n
    <span class="salres">for</span> k = between(40, 70)
    <span class="salres">output</span> <span class="special">#a</span>[<span class="saltyp">midi</span> <span class="keyword">time:</span> now() <span class="keyword">keynum:</span> k]
    <span class="salres">if</span> even?(k) <span class="salres">then</span>
      <span class="salres">output</span> <span class="special">#a</span>[<span class="saltyp">midi</span> <span class="keyword">time:</span> now() <span class="keyword">keynum:</span> k + 12]
      <span class="salres">else</span>
	<span class="salres">begin</span>
	  <span class="salres">output</span> <span class="special">#a</span>[<span class="saltyp">midi</span> <span class="keyword">time:</span> now() <span class="keyword">keynum:</span> k - 12]
	  <span class="salres">if</span> odds(.4) <span class="salres">then</span>
	    <span class="salres">output</span> <span class="special">#a</span>[<span class="saltyp">midi</span> <span class="keyword">time:</span> now() <span class="keyword">keynum:</span> k - random(12)]
	<span class="salres">end</span>
    <span class="salres">wait</span> random(r)
  <span class="salres">end</span>

<span class="salcmd">open</span> <span class="string">"test.mid"</span>

<span class="salcmd">sprout</span> foo(20, .4)
</pre>
</div>

<dl class="dictsyntax" id="load">
<dt>[Command]</dt>
<dd><code class="entry">load</code> <var>file</var></dd>
</dl>

<p> Loads <var>file</var> into Lisp.
</p>


<dl class="dictsyntax" id="open">
<dt>[Command]</dt>
<dd><code class="entry">open</code> [<var>stream</var>] {<var>keyword</var> :  <var>sexpr</var>}* </dd>
</dl>

<p> Opens a stream (connection) to a file, port, seq or plot. You can
pass a series of initializations to the output stream as appropriate
to its type when you open it.</p>

<dl class="dictsyntax" id="print">
<dt>[Command]</dt>
<dd><code class="entry">print</code> <var>sexpr</var> {<code class="entry">,</code> <var>sexpr</var>}*</dd>
</dl>

<p> Prints one or more comma-delimited <var>sexprs</var>. The printout appears in Common Music's REPL window.</p>

<dl class="dictsyntax" id="rts">
<dt>[Command]</dt>
<dd><code class="entry">rts</code> [<var>status</var>] </dd>
</dl>

<p> If <var>status</var> is not specified then the current status of <a href="rts-fn.html">rts</a> is reported (unloaded, stopped, paused or running). Otherwise <var>status</var> determines the status of the scheduler:
</p>

<blockquote>
<table class="float">
<tr><th class="lcol" style="padding-right: 1em;">status</th>  <th class="lcol">meaning</th></tr>
<tr><td>1</td> <td> start rts running using seconds as the scheduling time format</td></tr>
<tr><td>1000</td> <td>start rts running using milliseconds as the scheduling time format</td></tr>
<tr><td>-1</td><td> pause rts</td></tr>
<tr><td>0</td><td> stop rts</td></tr>
</table>
</blockquote>


<dl class="dictsyntax" id="sprout">
<dt>[Command]</dt>
<dd><code class="entry">sprout</code> <var>object</var> [<code class="entry">,</code> <var>offset</var>]</dd>
</dl>
<p>Triggers algorithmic output from <var>object</var> to
the <a href="#open">open output stream</a>. If a file is open each
sprout results in a new instance of that file being computed.
The <var>object</var> can be a single object (process, seq, etc) or a
list of the same. If <var>offset</var> is provided its value is a start time
offset or list of the same.
</p>


<!-- STATEMENTS -->

<h2 id="statements">Statements</h2>

<!-- BEGIN -->
<dl class="dictsyntax" id="begin">
<dt>[Statement]</dt>
<dd><code class="entry">begin</code> [<var>var-decl</var>] {<var>statement</var>}+ <code class="entry">end</code></dd>
</dl>

<p> Combines one or more statements into a single statement.  Optional local variables can be declared using the <a href="#with"><code>with</code></a> statement followed by a sequence of one or more statements and terminated with the required <code>end</code> tag.</p>

<!-- EXEC -->
<!-- 
<dl class="dictsyntax" id="exec">
<dt>[Statement]</dt>
<dd><code class="entry">exec</code> <var>sexpr</var> {<code class="entry">,</code> <var>sexpr</var>}*</dd>
</dl>
<p>Executes one or more comma-delimited sexprs.</p>
-->

<!-- IF -->
<dl class="dictsyntax" id="if">
<dt>[Statement]</dt>
<dd><code class="entry">if</code> <var>sexpr</var> <code class="entry">then</code> [<var>true-statement</var>] [<code class="entry">else</code> <var>false-statement</var>]
</dd>
</dl>

<p>Executes an optional <var>true-statement</var> if <var>sexpr</var> is true. Otherwise (<var>sexpr</var> is false) an optional <var>false-statement</var> is executed.</p>

<!-- LOOP -->
<dl class="dictsyntax" id="loop">
<dt>[Statement]</dt>
<dd><code class="entry">loop</code> [<var>var-decl</var>] {<var>stepping</var>}* {<var>stopping</var>}* {<var>action</var>}+ [<var>finally</var>]
 <code class="entry">end</code></dd>
</dl>

<p>Defines an iteration. Optional local variables can be declared using the <a href="#with"><code>with</code></a> statement followed by zero or more <var>stepping</var> statements, 
zero or more <var>stopping</var> statements, one or more <var>action</var> statements, an optional <var>finally</var> statement and terminated with the required <code>end</code> tag.</p> 

<blockquote>
<table class= "float">
<tr><th class="lcol" style="padding-right: 1em">stepping statements</th><th class="lcol">meaning</th></tr>
<tr><td><code>repeat</code> <var>sexpr</var></td> <td> sets the iteration limit to <var>sexpr</var> </td> </tr>
<tr><td><code>for</code> <var>var</var> <code class="entry">=</code> <var>sexpr</var> [<code>then</code> <var>sexpr2</var>]</td> <td> sets <var>var</var> to the value of <var>sexpr</var> on each iteration. If <code>then</code> is specified <var>sexpr</var> is the initial value and <var>sexpr2</var> are the subsequent values</td></tr>
<tr><td><code>for</code> <var>var</var> <code>in</code> <var>sexpr</var></td> <td> increments <var>var</var> over elements the list <var>sexpr</var></td></tr>
<tr><td><code>for</code> <var>var</var> [<code>from</code> <var>sexpr</var>] [<code>to|below</code> <var>sexpr</var>] [<code>by</code> <var>sexpr</var>]</td> <td> increments <var>var</var> from an on optional starting value to an ending value by an optional amount</td></tr>

<tr><th class="lcol" style="padding-right: 1em">stopping statements</th><th class="lcol">meaning</th></tr>
<tr><td><code>while</code> <var>sexpr</var></td> <td> iteration continues while <var>sexpr</var> is true</td> </tr>
<tr><td><code>until</code> <var>sexpr</var></td> <td> iteration stops when <var>sexpr</var> is true</td> </tr>


<tr><th class="lcol" style="padding-right: 1em;">action statements</th><th class="lcol">meaning</th></tr>
<tr><td> any SAL statement</td> <td>  statements are executed, they do not return values </td> </tr>
<tr><th class="lcol" style="padding-right: 1em;">finally statements</th><th class="lcol">meaning</th></tr>
<tr><td><code>finally</code> <var>statement</var></td> <td>executes <var>statement</var> as soon as iteration has completed</td></tr>

</table>


</blockquote>



<!-- OUTPUT -->
<dl class="dictsyntax" id="output">
<dt>[Statement]</dt>
<dd><code class="entry">output</code> <var>event</var> </dd>
</dl>

<p> Sends a musical <var>event</var> or list of the same to the <a href="#open">open output stream</a>. </p>

<!-- RETURN -->
<dl class="dictsyntax" id="return">
<dt>[Function Statement]</dt>
<dd><code class="entry">return</code> <var>sexpr</var> {<code class="entry">,</code> <var>sexpr</var>}*</dd>
</dl>

<p>Returns one or more comma-delimited values from a function.</p>



<!-- RUN -->
<dl class="dictsyntax" id="run">
<dt>[Process Statement]</dt>
<dd><code class="entry">run</code> [<var>var-decl</var>] {<var>stepping</var>}* {<var>stopping</var>}* {<var>statement</var>}+ [<var>finally</var>]
 <code class="entry">end</code></dd>
</dl>

<p> Almost identical in format to <a href="#loop">loop</a> but the iteration is defined over time, by a musical process. The <code>run</code> block supports the following additional statements:</p>


<blockquote>
<table class= "float">
<tr><th class="lcol" style="padding-right: 1em">stepping statements</th><th class="lcol">meaning</th></tr>
<tr><td><code>for</code> <var>var</var> <code>over</code> <var>pattern</var> [by <var>length</var>]</td> <td> increments <var>var</var> over items from <a href="patterns-topic.html"><var>pattern</var></a>. If <code>by</code> is specified then <var>var</var> is set to a list of <var>length</var> elements on each iteration. If the <var>length</var> is boolean true then <var>var</var> is set to the next period's worth of elements.</td></tr>
<tr><th class="lcol" style="padding-right: 1em;">action statements</th><th class="lcol">meaning</th></tr>
<tr><td><code>wait</code> <var>sexpr</var> </td> <td> causes the musical process to wait by <var>sexpr</var> seconds until the process runs again.</td></tr>
</table>
</blockquote>


<!-- SET -->
<dl class="dictsyntax" id="set">
<dt>[Statement]</dt>
<dd><code class="entry">set</code> <var>var</var> <var>op</var> <var>sexpr</var> {<code class="entry">,</code> <var>var</var> <var>op</var> <var>sexpr</var>}*</dd>
</dl>

<p> Assigns a value to one or more comma delimited
variables. Each variable <var>var</var> is set to the value of <var>sexpr</var>
according to the assignment operator <var>op</var>:</p>
<blockquote>
<table class= "float">
<tr><th class="lcol" style="padding-right: 1em;">operator</th><th class="lcol">meaning</th></tr>
<tr><td><code>=</code></td> <td> sets <var>var</var> to the value of <var>sexpr</var> </td> </tr>
<tr><td><code>+=</code></td> <td> increments <var>var</var> by the value of <var>sexpr</var> </td> </tr>
<tr><td><code>*=</code></td> <td> scales <var>var</var> by the value of <var>sexpr</var> </td> </tr>
<tr><td><code>&amp;=</code></td> <td> appends value of <var>sexpr</var> to the list in <var>var</var> </td> </tr>
<tr><td><code>@=</code></td> <td> prepends value of <var>sexpr</var> to the list in <var>var</var> </td> </tr>
<tr><td><code>&lt;=</code></td> <td> minimizes <var>var</var> with the value <var>sexpr</var> </td> </tr>
<tr><td><code>&gt;=</code></td> <td> maximizes <var>var</var> with the value <var>sexpr</var> </td> </tr>

</table>
</blockquote>

<!-- UNLESS -->
<dl class="dictsyntax" id="unless">
<dt>[Statement]</dt>
<dd><code class="entry">unless</code> <var>sexpr</var> <var>statement</var></dd>
</dl>

<p>Executes <var>statement</var> if the value of <var>sexpr</var> is false.</p>

<!-- WAIT -->
<dl class="dictsyntax" id="wait">
<dt>[Process Statement]</dt>
<dd><code class="entry">wait</code> <var>sexpr</var></dd>
</dl>

<p>Sets the next run time of the <a href="#define_process">musical process</a> to <var>sexpr</var>, typically a value in seconds.</p>


<!-- WHEN -->
<dl class="dictsyntax" id="when">
<dt>[Statement]</dt>
<dd><code class="entry">when</code> <var>sexpr</var> <var>statement</var></dd>
</dl>

<p>Executes <var>statement</var> if the value of <var>sexpr</var> is true.</p>


<!-- WITH -->
<dl class="dictsyntax" id="with">
<dt>[Statement]</dt>
<dd><code class="entry">with</code> <var>var</var> [<code class="entry">=</code> <var>sexpr</var>] {<code class="entry">,</code> <var>var</var> [<code class="entry">=</code> <var>sexpr</var>]}*</dd>
</dl>
<p>Declares one or more comma-delimited variables with optional initial values, which default to false if unspecified.  Declarations can appear at the start of block statements like <a href="#begin"><code>begin</code></a>, <a href="#loop"><code>loop</code></a> and <a href="#run"><code>run</code></a> </p>


<h2 id="sexprs">Symbolic expressions</h2>

<dl>

<dt>Numbers</dt>
<dd><p>Integers, floats and ratios. Example:</p>

<blockquote>
<pre><span class="salcmd">print</span> 1, 3.3, 1/3</pre>
</blockquote>
</dd>  

<dt>Booleans</dt>
<dd><p><code><span class="special">#t</span></code> is boolean true and <code><span class="special">#f</span></code> is boolean false.</p></dd>


<dt>Strings</dt>
<dd><p>A string of uninterpreted characters enclosed within <code><span class="string">""</span></code>. Example:</p>
<blockquote>
<pre><span class="salcmd">print</span> <span class="string">"A4 is "</span>, 440</pre>
</blockquote>
</dd>  


<dt>Identifiers</dt>
<dd><p>Alphanumeric names for variables, functions, etc.  Example:</p>
<blockquote>
<pre><span class="salcmd">print</span> pi, random(100)</pre>
</blockquote>
</dd>

<dt>Lists</dt>
<dd><p>Sequences of constant data enclosed within <code>{}</code>. Lists may contain numbers, identifiers, and other lists. Example:</p>

<blockquote>
<pre><span class="salcmd">print</span> {c 60 e 64}</pre>
</blockquote>
</dd>

<dt>Slot value references</dt>
<dd><p>A variable reference with a period delimited slot name appended to it. Slot value references can appear in expressions and values can be assigned to slots by the <a href="#set">set</a> statement. Example:</p>

<blockquote>
<pre><span class="salcmd">set</span> x = make(<span class="saltyp">&lt;midi&gt;</span>), x.keynum = random(100)
<span class="salcmd">print</span> x.keynum / 2</pre>
</blockquote>
</dd>


<dt>Array notation</dt>
<dd><p>A variable identifier followed by one or more comma-delimited indices enclosed within <code>[]</code>. Example:</p>

<blockquote>
<pre><span class="salcmd">set</span> x = list(100, 200, 300)
<span class="salcmd">print</span> x[1], " ", x[random(3)]
</pre>
</blockquote>


</dd>

<dt>Function call notation</dt>

<dd><p>A function name followed by zero or more comma-delimited arguments enclosed within <code>()</code>.
Commas must always separate the individual arguments. Some functions support <em>keyword arguments</em>, in which the name of the argument precedes its value. SAL keywords are identifiers ending with a colon. Example:</p>

<blockquote>
<pre><span class="salcmd">print</span> list()
<span class="salcmd">print</span> pick(100, 200, 300)
<span class="salcmd">print</span> note(440, <span class="keyword">hz:</span> <span class="special">#t</span>)
</pre>
</blockquote>


</dd>

<dt>Arithmetic expressions</dt>
<dd><p>Arithmetic sexprs are infix. Operators <em>must</em> be
delimited from their operands using spaces and/or parentheses. In
other words, 2 / 4 is division and 2/4 is a ratio; 2 + 4 is addition
and 2+4 is nothing. Standard operator precedence rules apply if no
parentheses are provided.</p>

</dd>

<!-- 

<dt id="constructor">Constructor notation</dt>

<dd>
  <p> A constructor expression creates an object from its
description. Constructor expressions are introduced by <code>#a</code>
and the expression is enclosed within square brackets:
<code>[</code><var>type</var> {<var>form</var>}*<code>]</code> where
<var>type</var> is the type name of the object to construct and
<var>form</var> changes according to the type of object under
construction.</p>

  <ul><li id="object_constructor"><p>Object constructors are comprised of the class of the object followed by zero or more keyword slot initializations:</p>

<pre><span class="special">#a</span>[<span class="saltyp">midi</span> <span class="keyword">time:</span> 0 <span class="keyword">keynum:</span> random(127)]</pre>
</li>
<li id="list_constructor"><p>List and vector constructors use a simplified loop syntax with a special <code>collect</code> statement:</p>
<pre><span class="special">#a</span>[<span class="saltyp">list</span> for i below 10 collect i]
<span class="special">#a</span>[<span class="saltyp">list</span> for x to 100 by 10 for y = between(60, 80) collect x, y]
<span class="special">#a</span>[<span class="saltyp">vector</span> repeat 10 collect random(32)]
</pre>
</li>

<li id="pattern_constructor"><p>Pattern constructors are similar to CM's <a href="pattern-mac.html">pattern</a> macro:</p>
<pre><span class="special">#a</span>[<span class="saltyp">cycle</span> 1 2 3 4 5]
<span class="special">#a</span>[<span class="saltyp">heap</span> of notes c4 d e f g a c5 for 5]
<span class="special">#a</span>[<span class="saltyp">weighting</span> a b {c weight 3} d e ]
</pre>
</li>
</ul>
</dd>
</dl>

-->

<h2 id="reserved">Reserved Symbols</h2>

<p>
<a href="#begin"><code>begin</code></a>
<a href="#loop"><code>below</code></a>
<a href="#loop"><code>by</code></a>
<a href="#list_constructor"><code>collect</code></a>
<a href="#define"><code>define</code></a>
<a href="#if"><code>else</code></a>
<a href="#begin"><code>end</code></a>
<a href="#exec"><code>exec</code></a>
<a href="#loop"><code>finally</code></a>
<a href="#loop"><code>for</code></a>
<a href="#loop"><code>from</code></a>
<a href="#if"><code>if</code></a>
<a href="#loop"><code>in</code></a>
<a href="#loop"><code>loop</code></a>
<a href="#output"><code>output</code></a>
<a href="#run"><code>over</code></a>
<a href="#print"><code>print</code></a>
<a href="#loop"><code>repeat</code></a>
<a href="#return"><code>return</code></a>
<a href="#run"><code>run</code></a>
<a href="#set"><code>set</code></a>
<a href="#sprout"><code>sprout</code></a>
<a href="#if"><code>then</code></a>
<a href="#loop"><code>to</code></a>
<a href="#unless"><code>unless</code></a>
<a href="#loop"><code>until</code></a>
<a href="#wait"><code>wait</code></a>
<a href="#when"><code>when</code></a>
<a href="#loop"><code>while</code></a>
<a href="#until"><code>with</code></a>
</p>

<h2 id="lacunae">Lacun&aelig;</h2>

<ul>

  <li>Exact syntax of some commands is not settled yet. In particular
  the (inconsistent) use of comma delimiting in commands to be
  settled. </li>

  <li>Perhaps the <code>print</code> command should automatically
  print spaces between comma-delimited arguments?  </li>

  <li>Some reserved words in SAL necessarily shadow Lisp function
  symbols with the same name, most notably: <code>+ - * /
  if</code>. To get at these Lisp functions you can use the Sal
  replacements: <code>plus minus times divide if?</code>. </li>

  <li>Unlike Lisp keywords, Sal keyword names are not symbolic
  expressions. You can still pass Lisp keywords as values, ie
  <code>:foo</code> is a legal identifier in Sal and since it is a
  self-evaluating form in Lisp it can be passed as a value.</li>

  <li>The distinction between commands and statements is a bit arbitrary, pehaps all statements should be commands, i.e. capable of being executed.</li>

</ul>

</div>
</body>
</html>

