<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
<style type="text/css" media="all">
@import "cm.css";
</style>
<title>Common Music 3</title>
</head>

<body>
<div id="content">

<h1> Common Music 3</h1>

<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#toolbox">Composition Toolbox</a>
  <ul>
    <li><a href="#numbers">Numbers</a></li>
    <li><a href="#lists">Lists</a></li>
    <li><a href="#mapping">Mapping and Transformation</a></li>
    <li><a href="#randomness">Randomness</a></li>
    <li><a href="#patterns">Patterns</a></li>
    <li><a href="#spectral">Spectral Composition</a></li>
    <li><a href="#files">File System</a></li>
  </ul>
  </li>

   <li><a href="#iteration">Iteration</a></li>
 
  <li><a href="#audio">Audio</a>
  <ul><li><a href="#send">Sending Audio Data</a></li>
  
  <li><a href="#midi-out">Midi Out</a></li>
  <li><a href="#midi-in">Midi In</a></li>
  <li><a href="#csound">Csound</a></li>
  <li><a href="#sndlib">SndLib</a></li>
</ul>
</li>


<li><a href="#scheduler">The Scheduler</a>
<ul>
    <li><a href="#processes">Processes</a></li>
    <li><a href="#sprout">sprout</a></li>
    <li><a href="#scheduling">Other Scheduling functions</a></li>
</ul>
</li>

<li><a href="#plotting">Plotting</a></li>


<li><a href="#sal">SAL</a>
<ul>
 <li><a href="#expressions">Expressions</a></li>
  <li><a href="#assignment">Assignment</a></li>
  <li><a href="#conditionals">Conditionals</a></li>
  <li><a href="#definitions">Definitions</a>
  <ul>
    <li><a href="#variables">Variables</a></li>
    <li><a href="#functions">Functions</a></li>

  </ul>
  </li>
  <li><a href="#environment">Environment</a></li>

 <li><a href="#sal_reserved">SAL Reserved Symbols</a></li>
 <li><a href="#sal_scheme_cltl">Table of SAL, Scheme and Common Lisp</a></li>
</ul>
</li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>The Common Music 3 branch is implemented in Scheme (SndLib/S7 or <a
href="http://www.call-with-current-continuation.org">Chicken
Scheme</a>) and optimized for interactive work and real-time scheduling. Since this triggered major design changes to the underlying code (and thereby ruled out source compatibility with earlier CM versions) I have  taken this opportunity to make the API a leaner, more consistent and (hopefully) a more expressive one than the CM2 branch.
</p>

<p>
The distinguishing features of the Common Music 3 line compared to
the previous version are:
</p>

<ul>
  <li>Does not require source tree at runtime.</li>
  <li>Does not depend on an object system or generic functions.</li>

  <li>Terser calling syntax facilitates interactive coding:
  <ul>
    <li>No dependence on quoted symbols or keywords in argument data.</li>
    <li>Numerous functions expanded to handle lists as well as atomic data. This reduces the number of functions in the API and helps minimize the need for ad hoc looping to process list data. In the documentation separate formals are provided in cases where list handling causes a significant difference in argument syntax.</li>
    <li>Functions that take variable arguments also permit a single list argument.</li>

   <li><a href="#sal:optkey-parameters">Opt/key</a> parameters with DSSSL style keywords (symbols ending with a colon) replace &amp;optional and &amp;keyword parameters.  </li>
    <li>Shorter names in general.</li>
  <li>Note names support quarter-tone inflection. </li>
  </ul>
</li>

<li>SAL and Scheme equivalence. Scheme formals are only shown when they differ in some significant way from the SAL versions. </li>

<li>Ports replace files. </li>
</ul>
<h2 id="toolbox">Composition Toolbox</h2>

<p>The following functions have been added to Scheme to facilitate algorithmic music composition. </p>

<h3 id="numbers">Numbers</h3>


<!-- DEFINITION -->
<table class="entry" id="fit">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">fit</span>
      (<var class="arg">num</var>, <var class="arg">min</var>, <var class="arg">max</var>, [<var class="opt">mode</var> <var class="optval">1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>

Returns <var>num</var> or list of same bounded by <var>min</var> and
<var>max</var> according to <var>mode</var>. If <var>min</var> &lt;=
<var>num</var> &lt;= <var>max</var> then <var>num</var> is
returned. Otherwise, if <var>mode</var> is 1 then the outlying
<var>num</var> is wrapped between <var>min</var> and <var>max</var>,
i.e. fit returns the remainder of number modulus the boundary
range. If <var>mode</var> is 2, then the <var>min</var> and
<var>max</var> boundaries reflect the outlying value back into range.
If <var>mode</var> is 3 then the boundary value (<var>min</var> or
<var>max</var>) is returned.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="int">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">int</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Rounds floating point <var>num</var> or list of the same to the nearest integer.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="float">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">float</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Coerces <var>num</var> or list of the same to a floating point value.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="quantize">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">quantize</span>
      (<var class="arg">num</var>, <var class="arg">step</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Quantizes <var>num</var> or list of the same to be a multiple of <var>step</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="plus">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plus</span>
      (<var class="rest">nums...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plus</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
    <tr class="entry">
    <td class="formals">
      <span class="funcname">plus</span>
      (<var class="arg">list</var>, <var>num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the addition of zero or more <var>nums</var>. If a single <var>list</var> of numbers is given they are summed together. Otherwise a list is returned of <var>num</var> added to every element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="minus">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var class="arg">num</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
    <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var class="arg">list</var>, <var>num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the subtraction of one or more <var>nums</var>. If a single number is given its inverse is returned. If a single <var>list</var> of numbers is given the cumulative subtraction is returned. Otherwise a list is returned of <var>num</var> subtracted from every element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="times">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">times</span>
      (<var class="rest">nums...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">times</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">times</span>
      (<var class="arg">list</var>, <var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the multiplication of zero or more <var>nums</var>. If a single <var>list</var> of numbers is given they are multiplied together.  Otherwise a list is returned of <var>num</var> multiplied with every element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="divide">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">divide</span>
      (<var class="arg">num</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">divide</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">divide</span>
      (<var class="arg">list</var>, <var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the division of one or more <var>nums</var>. If a single number is given its inverse is returned. If a single <var>list</var> of numbers is given the cumulative division is returned. Otherwise a list is returned of <var>num</var> divided into every element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="log10">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">log10</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number </td></tr>
</table>
<blockquote>
<p>
Returns log <span style="vertical-align: middle; font-size:x-small;">10</span> of <var>num</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="log2">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">log2</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number </td></tr>
</table>
<blockquote>
<p>
Returns log <span style="vertical-align: middle; font-size:x-small;">2</span> of <var>num</var>.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="pi">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pi</span>
    </td>
    <!-- td class="label">Variable</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; 3.141592653589793</td></tr>
</table>
<blockquote>
<p>
The value of <var>pi</var> as a double float.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="most-positive-fixnum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">most-positive-fixnum</span>
    </td>
    <!-- td class="label">Variable</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; Implementation dependent value</td></tr>
</table>
<blockquote>
<p>
The largest positive fixed point integer representable in this Lisp implementation.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="most-negative-fixnum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">most-negative-fixnum</span>
    </td>
    <!-- td class="label">Variable</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; Implementation dependent value</td></tr>
</table>
<blockquote>
<p>
The largest negative fixed point integer representable in this Lisp implementation.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="lists">Lists</h3>

<!-- DEFINITION -->
<table class="entry" id="first">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">first</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; element</td></tr>
</table>
<blockquote>
<p>
Returns the first element in <var>list</var>. Similar accessors for the <code><span class="funcname">second</span></code> to <code><span class="funcname">tenth</span></code> elements are also defined.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="last">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">last</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; element</td></tr>
</table>
<blockquote>
<p>
Returns the last element in <var>list</var>. Note that this is not the same as Common Lisp's version (see <a href="#tail"><code>tail</code></a>).
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="nth">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">nth</span>
      (<var class="arg">list</var>, <var class="arg">pos</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; element</td></tr>
</table>
<blockquote>
<p>
Returns the element at <var>pos</var> position (zero based) in <var>list</var>. Note that this is not the same as Common Lisp's version which (confusingly) reverses the arguments.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="butlast">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">butlast</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of all but the last element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rest">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rest</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of all but the first element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="tail">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">tail</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns the tail (last cdr) of <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="unique">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">unique</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Return a copy of <var>list</var> with duplicate elements removed.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="list_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list*</span>
      (<var class="rest">...</var> <var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Prepends elements in <var>...</var> onto the front of <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="concat">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">concat</span>
      (<var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Concatenates its inputs, which can be lists and non-lists, into a single list.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="make-list">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-list</span>
      (<var class="arg">length</var> [<var class="opt">fill</var> <var class="optval"> #f</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-list</span>
      (<var class="arg">length</var> [<var class="opt">function</var>] <var class="rest">args...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>

Creates a new list with <var>length</var> number of elements.  If <var>fill</var> is provided the initial elements in the list are set to it. If <var>function</var> is provided it is called <var>length</var> times with zero or more <var>args...</var> to produce the contents of the list.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="list-set_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list-set!</span>
      (<var class="arg">list</var>, <var class="arg">pos</var>, <var class="arg">val</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; element</td></tr>
</table>

<blockquote>
<p>
Sets the element at <var>pos</var> position in <var>list</var> to <var>val</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="sort">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sort</span>
      (<var class="arg">list</var>  [<var class="opt">comparator</var> <code>&lt</code>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a sorted copy of <var>list</var> given a pairwise <var>comparator</var> function of two arguments. The comparator should return true if the value  in its first argument will appear before the value in the second argument in the sorted results, otherwise the comparator should return false. The default comparator is <code>&lt;</code>.  
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="sort!">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sort!</span>
      (<var class="arg">list</var>  [<var class="opt">comparator</var> <code>&lt</code>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Exactly like <a href="#sort"><code>sort</code></a> except that <var>list</var> is destructively modified to hold the sorted results.
</p>
</blockquote>
<!-- END DEFINITION -->







<h3 id="mapping">Mapping and Transformation</h3>

<!-- DEFINITION -->
<table class="entry" id="note">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">note</span>
      (<var class="arg">nkl</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; string or list</td></tr>
</table>
<blockquote>
<p>

Returns the note (string) of <var>nkl</var>, which can be a note, key
or list of the same. A note name consists of a pitch class letter
(<code>c</code> <code>d</code> <code>e</code> <code>f</code>
<code>g</code> <code>a</code> <code>b</code>), an optional sharp or
flat letter (<code>s</code> <code>f</code>) an optional quarter tone
inflection (<code>&lt;</code> or <code>&gt;</code>) and an octave
number (<code>00</code> to <code>9</code>). Note names can be
specified as strings, symbols or keywords. Octave numbers inside note
lists can be omitted, in which case the current note's octave defaults
to the last octave specified, or to octave 4.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="key">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">key</span>
      (<var class="arg">nhl</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns the key (number) of <var>nhl</var>, which can be a note, hertz or list of the same. A floating point key <var>kkk.cc</var> is interpreted as the frequency <var>cc</var> cents above the integer key number <var>kkk</var>, e.g. 60.5 is 50 cents above Middle C.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="hz">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">hz</span>
      (<var class="arg">nkl</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns the hertz value of <var>nkl</var>, which can be a note, key or list of the same.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="pc">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pc</span>
      (<var class="arg">nkl</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns pitch class (0-11) of <var>nkl</var>, which can be a note, key or list of the same.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="transpose">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">transpose</span>
      (<var class="arg">nkl</var>, <var class="arg">amount</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Transposes <var>nkl</var> by <var>amount</var>.
If <var>freq</var> and <var>amount</var> are both pitch classes then the transposition occurs in pitch class (mod 12) space. Otherwise <var>nkl</var> should be a key, note or list of the same and it is transposed by <var>amount</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="invert">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">invert</span>
      (<var class="arg">nkl</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
If <var>nkl</var> is a pitch class or list of pitch classes the pitch class complement(s) are returned. Otherwise <var>nkl</var> should be a list of notes or keys and the (strict) inversions around the first key or note in the list is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="retrograde">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">retrograde</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a version of <var>list</var> with its elements reversed.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="scale">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale</span>
      (<var class="arg">num</var>, <var class="arg">start</var>, <var class="rest">step...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale</span>
      (<var class="arg">num</var>, <var class="arg">start</var>, <var class="arg">list</var>, [<var class="opt">limit #f</var>], [<var class="opt">mode</var> 1])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of <var>num</var> keys starting on <var>start</var> and incremented by each <var>step</var> (positive or negative) or <var>list</var> of steps provided. If a <var>limit</var> key is provided then scale degrees will always lie between <var>start</var> and <var>limit</var> according to <var>mode</var> (see <a href="#fit"><code>fit</code></a>).


</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="scale-order">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale-order</span>
      (<var class="arg">list</var>, [<var class="opt">mode</var> <var class="optval">1</var>])</td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a <var>list</var> of notes, keys or hertz values ordered according to <var>mode</var>, where 1 means ascending order, -1 means descending order and 0 means random order.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="scale-order_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale-order!</span>
      (<var class="arg">list</var>, [<var class="opt">mode</var> <var class="optval">1</var>])</td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Like <a href="#scale-order"><code>scale-order</code></a> except that <var>list</var> is destructively modified by the ordering.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rhythm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rhythm</span>
      (<var class="arg">rhy</var>, [<var class="opt">tempo 60</var>], [<var class="opt">beat</var> 1/4])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
 Returns the value of <var>rhy</var> converted to beat units
(typically seconds) at a specified tempo. <var>Rhy</var> can be any fraction of a whole
note, a <var>rhythmic symbol</var> or a list of the same. A fraction of a whole note is simply a ratio, e.g. 1/4=quarter note, 1/8=eighth note, 3/2=three half-notes, 7/25=seven twenty-fifths notes, and so on. A rhythmic symbol consists of a metric letter (<code>w</code>=whole,<code>h</code>=half, <code>q</code>=quarter, <code>e</code>=eighth, <code>s</code>=sixteenth, <code>t</code>=thirty-second, <code>x</code>=sixty-fourth) optionally preceded by a triplet marker (<code>t</code>) and optionally followed by one or more dots (<code>.</code>). Expressions involving symbols can be formed using <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> to join the rhythmic tokens. Examples:

<code>q</code>=quarter, 
<code>tq</code>=triplet quarter, 
<code>e.</code>=dotted-eighth, 
<code>ts.</code>=triplet dotted sixteenth, 
<code>h...</code>=triple dotted half, 
<code>s+tq</code>=sixteenth plus triplet quarter, 
<code>w-ts</code>=whole minus triplet sixteenth,
<code>w*4</code>=four whole notes. 
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="in-tempo">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">in-tempo</span>
      (<var class="arg">beats</var>, <var class="arg">tempo</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>Scales a  <var>beat</var> value by a metronome <var>tempo</var> value: <var>beats</var>*(60/<var>tempo</var>)
</p>
</blockquote>
<!-- END DEFINITION -->




<!-- DEFINITION -->
<table class="entry" id="rescale">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rescale</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>,  <var class="arg">x2</var>, <var class="arg">y1</var>, <var class="arg">y2</var>, [<var class="opt">base</var> <var class="optval">1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>

<blockquote>
<p>Returns a floating point value between <var>y1</var> and <var>y2</var> that is proportional to a floating point <var>x</var> or list of the same lying between <var>x1</var> and <var>x2</var>. If <var>base</var> is 1 the rescaling is linear otherwise its exponential where <var>base</var> &gt; 1 produce increasing spread as <var>x</var> approaches <var>x2</var> and values  &lt; 1 produce decreasing spread.</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="discrete">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">discrete</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>, <var class="arg">x2</var>, <var class="arg">i1</var>, <var class="arg">i2</var>, [<var class="opt">base</var> = <var class="optval">1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">discrete</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>, <var class="arg">x2</var>, <var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval" colspan="2">&rarr; integer, element or list</td></tr>
</table>
<blockquote>
<p>
Similar to <code>rescale</code> except floating point <var>x</var> is mapped onto integer values between <var>i1</var> and <var>i2</var>, or onto the elements in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="segs">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">segs</span>
      (<var class="arg">num</var>, <var class="arg">sum</var>, [<var class="opt">mode</var> <var class="optval">1</var>],  [<var class="opt">base</var> <var class="optval">2</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>

  <tr class="entry">
    <td class="formals">
      <span class="funcname">segs</span>
      (<var class="arg">num</var>, <var class="arg">sum</var>, [<var class="opt">mode</var> <var class="optval">3</var>],  [<var class="opt">gen</var> <a href="#ran"><var class="optval">ran</var></a>], <var class="rest">args...</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>

Returns <var>num</var> segments adding up to <var>sum</var>, where the
relationship between each segment is determined by <var>mode</var>. If
<var>mode</var> is 1 then the segments are exponentially related,
where <var>base</var> values greater than 1 produce exponentially
increasing segments, and reciprocals produce exponentially decreasing
segments. If <var>mode</var> is 2 then the segments returned are
related by the <a
href="http://en.wikipedia.org/wiki/Geometric_series">geometric
series</a>. If <var>mode</var> is 3 then random segments are returned
where <var>gen</var> is the random function to use and
<var>args...</var> are any values to pass to it.

</p>
</blockquote>
<!-- END DEFINITION -->



<!-- DEFINITION -->
<table class="entry" id="interp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">interp</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>,  <var class="arg">y1</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">interp</span>
      (<var class="arg">x</var>, <var class="arg">list</var>,  [<var class="opt">base 1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>

<p> Returns the interpolated y value of <var>x</var> in a series of
<var>x1 y1 ...</var> coordinate pairs or envelope list of the same.
If the coordinates are specified as a list then an optional
<var>base</var> can control the type of interpolation (linear or
exponential) used. See <a href="#rescale"><code>rescale</code></a> for
more information.  </p>

</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ratio-_cents">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ratio-&gt;cents</span>
      (<var class="arg">scaler</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Converts a frequency ratio <var>scaler</var> or list of the same to the equivalent in cents.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ratio-_steps">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ratio-&gt;steps</span>
      (<var class="arg">scaler</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Converts a frequency ratio <var>scaler</var> or list of the same to the equivalent in half-steps.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="cents-_ratio">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">cents-&gt;ratio</span>
      (<var class="arg">cents</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Converts a <var>cent</var> value or list of the same to the equivalent frequency scaler.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- dl id="decimals">
<dt class="entry"><span class="term">decimals</span> (<var>x</var> [<var>precision</var> 3])<br/>&rarr; <var>float</var></dt>
<dd><p>Same as CM. </p></dd></dl -->

<h3 id="randomness">Randomness</h3>

<p>All the functions that perform random selection are based on a common C++ random
state object that can be seeded using <a href="#ran-set_"><code>ran-set!</code></a>.</p>

<h4>Uniform Distribution</h4>


<!-- DEFINITION -->
<table class="entry" id="ran">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ran</span>
      ([<var class="opt">num</var> <var class="optval"> 1.0</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>

<blockquote>
<p>
Returns a random number between 0 and <var>num</var> (exclusive). If
<var>num</var> is an integer greater than 1 then an integer will be returned otherwise a floating point value is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="between">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">between</span>
      (<var class="arg">a</var>, <var class="arg">b</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns a randomly chosen number between <var>a</var> and <var>b</var> (exclusive). The value of  <var>b</var> can be less than <var>a</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="vary">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">vary</span>
      (<var class="arg">value</var>, <var class="arg">pct</var>,
      [<var class="opt">mode</var> <var class="optval">0</var>]
      )
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns a random number that deviates from <var>value</var> or list of
the same by up to <var>pct</var> (1=100%) according to
<var>mode</var>. If <var>mode</var> is 0 then <var>value</var> is at
the center of what could be returned.  If <var>mode</var> is -1 then
<var>value</var> is the maximum possible value, otherwise
<var>mode</var> 1 places <var>value</var> at the minimum of what could
be returned.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="odds">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">odds</span>
      (<var class="arg">num</var>, [<var class="opt">true</var> <var class="optval">#t</var>], [<var class="opt">false</var> <var class="optval">#f</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; value</td></tr>
</table>
<blockquote>
<p>
Returns <var>true</var> value if a randomly chosen number between 0.0 and 1.0 is less than <var>num</var> else returns <var>false</var> value.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="pick">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pick</span>
      (<var class="rest">arg...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pick</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; value</td></tr>
</table>
<blockquote>
<p>
Returns a randomly selected <var>arg</var> as the value of the function. If just one argument is given it should be a <var>list</var> and a randomly selected value from the list is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="shuffle">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shuffle</span>
      (<var class="arg">args...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shuffle</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>

Returns a version of <var>args...</var> or a <var>list</var> of the same with the elements randomly reordered.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="shuffle_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shuffle!</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>

Like <a href="#shuffle"><code>shuffle</code></a> except that <var>list</var> is destructively modified by the random reordering.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="tendency">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">tendency</span>
      (<var class="arg">x</var>, <var class="arg">low</var>, <var class="arg">high</var>, [<var class="opt">gen</var> <a href="#ran"><var class="optval">ran</var></a>], <var class="rest">args...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Returns a random lying between the values of <var>x</var> in the <var>low</var> and <var>high</var> envelopes. If <var>low</var> or <var>high</var> are constant for any <var>x</var> they may be numbers rather than envelopes. <var>Gen</var> is an optional random function that will be applied to <var>args...</var> to generate the random number between <var>low</var> and <var>high</var>.

</p>
</blockquote>
<!-- END DEFINITION -->



<h4>Nonuniform Distributions</h4>

<!-- DEFINITION -->
<table class="entry" id="ranpink">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranpink</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a pinkish  (1/f)  value between -1 and 1.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranbrown">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranbrown</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a brownish  (1/f<sup>2</sup>) value between -1 and 1.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranlow">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranlow</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value between 0 and 1 with lower values more likely.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranhigh">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranhigh</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value between 0 and 1 with higher values more likely.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranmiddle">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranmiddle</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value between 0 and 1 with middle values more likely.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rangauss">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rangauss</span>
      ([<var class="opt">a</var> <var class="optval">1</var>], [<var class="opt">b</var> <var class="optval">0</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns unbounded value from the  <a href="http://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a> with standard deviation <var>a</var> (sigma) and mean <var>b</var> (mu).
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranexp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranexp</span>
      ([<var class="opt">lambda</var> <var class="optval">1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value greater than 0 from the  <a href="http://en.wikipedia.org/wiki/Exponential_distribution">exponential distribution</a> with stretching factor <var>lambda</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranbeta">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranbeta</span>
      ([<var class="opt">a</var> <var class="optval">.5</var>], [<var class="opt">b</var> <var class="optval">.5</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns value between 0 and 1 from the  <a href="http://en.wikipedia.org/wiki/Beta_distribution">beta distribution</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rangamma">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rangamma</span>
      ([<var class="opt">k</var> <var class="optval">1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns value greater than 0 from the  <a href="http://en.wikipedia.org/wiki/Gamma_distribution">gamma distribution</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rancauchy">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rancauchy</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns an unbounded value from the <a href="http://en.wikipedia.org/wiki/Cauchy_distribution">Cauchy distribution</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranpoisson">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranpoisson</span>
      ([<var class="opt">lambda</var> <var class="optval">1</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns an unbounded integer value from the <a href="http://en.wikipedia.org/wiki/Poisson_distribution">Poisson distribution</a> with shape factor <var>lambda</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4>Seeding</h4>

<!-- DEFINITION -->
<table class="entry" id="ran-set_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ran-set!</span>
      (<var class="arg">uint</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Initialize the random state generator with the unsigned integer value <var>uint</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="patterns">Patterns</h3>

<p>

Patterns are objects that generate data in different orderings. Data
can be constants (numbers, symbols, lists, etc), sub-patterns, or
thunks (functions of zero arguments). Use <a
 href="#next"><code>next</code></a> to return the next value from a pattern;
constant data are simply returned from the pattern, sub-patterns produce
local orderings within the larger pattern and thunks are called to
produce data.

</p>

<div class="float" id="table_1">
<table>
<tr><th class="lcol">Pattern</th><th class="lcol">Description</th></tr>
<tr><td><a href="#make-cycle">Cycle</a> </td><td>generates its elements in a continuous loop</td></tr>
<tr><td><a href="#make-line">Line</a></td><td>generates its elements sequentially and sticks on last element</td></tr>
<tr><td><a href="#make-palindrome">Palindrome</a></td><td>generates its elements forwards and backwards</td></tr>
<tr><td><a href="#make-heap">Heap</a></td><td>generates random permutations of its elements</td></tr>
<tr><td><a href="#make-rotation">Rotation</a></td><td>generates systematic permutations of its elements</td></tr>
<tr><td><a href="#make-weighting">Weighting</a></td><td>generates elements from a weighted random distribution</td></tr>
<tr><td><a href="#make-markov">Markov</a></td><td>generates nth order Markov chains of its elements</td></tr>
<tr><td><a href="#make-graph">Graph</a></td><td>generates elements from a directed graph</td></tr>
</table>
</div>

<table id="make-cycle" class="entry">
  <tr class="entry">
    <td class="formals">
    <span class="funcname">make-cycle</span>
      (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates its elements in a continual loop.
<var>Items</var> is the list of data to generate and can include sub-patterns.
<var>For</var> sets the number of internal reads that will make up the next period, or chunk, of data returned from the pattern. This value can be a number or pattern of numbers and defaults to the length of <var>items</var>.
<var>Repeat</var> sets an optional limit on the number of periods that the pattern can generate; once this limit has
been reached the pattern will return an <a href="#eod_">end of data</a> marker instead of elements.
</p>
</blockquote>

<table id="make-line" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="term">make-line</span>
      (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates <var>items</var> sequentially and sticks on the last item.
</p>
</blockquote>

<table id="make-palindrome" class="entry">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-palindrome</span>
    (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>, <var class="optkey">elide</var> <var class="optval"> = #f</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates <var>items</var> forwards and backwards. <var>Elide</var> determines what happens to the first and last items when the pattern reverses itself. If the value is false then these items are repeated. If the value is true then neither item is directly repeated. Otherwise the value can should be a two element list {<var>bool</var> <var>bool</var>} specifying the repeat value for the first and last item.
</p>
</blockquote>

<table id="make-weighting" class="entry">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-weighting</span>
    (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>  
<blockquote>
<p>
Returns a weighting pattern that generates <var>items</var> from a weighted distribution.
Each item can be an item, sub-pattern, or list:
</p>
<blockquote>
  <p><code>{<var>item</var> [<var>weight 1</var>] [<var>min 1</var>] [<var>max #f</var>]}</code></p>
</blockquote>
<p>
where <var>item</var> is the thing to generate, <var>weight</var> is its weight in the distribution relative to the other items in the pattern, <var>min</var> is the minimum number of times that <var>item</var> must be directly selected before another item can be considered, and <var>max</var> is the maximum number of times that <var>item</var> can be directly selected before another item must be selected.
</p>
</blockquote>


<table id="make-rotation" class="entry">
  <tr class="entry">
    <td class="formals">
    <span class="funcname">make-rotation</span>
      (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>, <var class="optkey">rotate</var> <var class="optval"> = {0}</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that rotates its items according to <var>rotate</var>, which can be a list or a pattern of lists of the format:
</p>
<blockquote>
  <p><code>{<var>start</var> [<var>end</var>] [<var>step 1</var>] [<var>width 1</var>]}</code></p>
</blockquote>
</blockquote>
  
<table id="make-markov" class="entry">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-markov</span>
    (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>, <var class="optkey">past </var> <var class="optval"> = {...}</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates its items according to (nth order) transitions lists:
</p>
<blockquote>
  <p><code>{<var>past ...</var> -&gt; {<var>next weight</var>} <var>...</var>}</code></p>
</blockquote>
<p>
Items appearing before <code>-&gt;</code> in the rule are the past choice(s) that trigger the transition and items following <code>-&gt;</code> make up the weighted distribution determining the transition's next outcome. If <var>past</var> it supplied it will be the initial past choices to match the transitions against, otherwise the first transition rule is used.
</p>
</blockquote>

<!-- DEFINITION -->
<table class="entry" id="markov-analyze">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">markov-analyze</span>
      (<var class="arg">list</var>, <var class="opt">order</var> = <var class="optval">1</var>, <var class="opt">mode</var> = <var class="optval">1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void, pattern or list</td></tr>
</table>
<blockquote>
<p>
Analyzes a <var>list</var> of data for a specified Markov <var>order</var> (0-n) and computes a table capturing the Markov transitions rules that generates a version <var>data</var> for the supplied <var>order</var>. Returns results according to <var>mode</var>. If <var>mode</var> is 1 then the transition table is printed in an easy to read row and column format. If mode is 2 then a <a href="#make-markov">markov pattern</a> containing the table is returned. If <var>mode</var> is 3 then the table is returned as a list of items suitable for passing to <a href="#make-markov"><code>make-markov</code></a>.
</p>
</blockquote>
<!-- END DEFINITION -->


<table id="make-graph" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-graph</span>
      (<var class="arg">items</var>, <var class="optkey">for</var> <var class="optval"> = #f</var>, <var class="optkey">repeat</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates its items from a directed graph of nodes with transition patterns. Each node is a list:
</p>
<blockquote>
  <p><code>{<var>item</var> <var>to</var> [<var>id</var>]}</code></p>
</blockquote>
<p>
where <var>item</var> is the item or pattern to generate, <var>to</var> is an id or pattern of ids identifying which node should follow the current node in the graph, and <var>id</var> is a unique identifier for the node which defaults to the node's position in <var>items</var> starting from 1.
</p>
</blockquote>

<!-- DEFINITION -->
<table class="entry" id="next">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">next</span>
      (<var class="arg">pattern</var>, [<var class="opt">chunk</var> <var class="optval">#f</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; element or list</td></tr>
</table>
<blockquote>
<p>
Returns one or more elements from <var>pattern</var> according
to <var>chunk</var>. If <var>chunk</var> is false
then the next element from <var>pattern</var> is
returned. If <var>chunk</var> is a number then that many elements are
read from the pattern and returned in a list. Otherwise if <var>chunk</var> is true then the next period's worth of data is returned in a list.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="eop_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">eop?</span>
      (<var class="arg">pattern</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; boolean</td></tr>
</table>
<blockquote>
<p>
Returns true if <var>pattern</var> is at the end of its current period. <var>Pattern</var>
can be a pattern or the value returned from the pattern by <a href="#next">next</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="eod_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">eod?</span>
      (<var class="arg">pattern</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; boolean</td></tr>
</table>
<blockquote>
<p>
Returns true if <var>pattern</var> is at the end of its data.  This condition can only happen if the pattern was created with a <var>repeat</var> value explicitly provided. <var>Pattern</var>
can be a pattern or the value returned from the pattern by <a href="#next">next</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="promise">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">promise</span>
      (<var class="arg">expr</var>)
    </td>
    <!-- td class="label">Macro</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; function</td></tr>
</table>
<blockquote>
<p>
Turns <var>expr</var> into a function of zero arguments that, when called, returns the value of <var>expr</var>. Use promise to embed expressions in pattern data, when a promise is read by <a href="#next"><code>next</code></a> the value it returns becomes the value of next.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="spectral">Spectral Composition</h3>

<p>
The following functions create, access or modify <var>spectrum</var> objects. A spectrum holds a sequence of frequencies, an (optional) sequence of amplitudes and an (optional) time value. A spectrum can be sent to and from plotter displays for graphic editing and converted to other representations, for example to lists of notes and keys. <!-- Spectra can passed between Scheme and C++, for example sending them to a plotter window for display. -->
</p>

<h4>Creating Spectra</h4>

<!-- DEFINITION -->
<!--
<table class="entry" id="make-spectrum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-spectrum</span>
      (<var class="arg">freqs</var>, [<var class="optvar">amps</var> <var class="optval">#f</var>], [<var class="optvar">time</var> <var class="optval">#f</var>])
    </td>

  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Creates a spectrum out of the specified <var>freqs</var> (list of hertz values) an optional list of <var>amps</var> and an optional <var>time</var>.
</p>
</blockquote>
-->
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="fm-spectrum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">fm-spectrum</span>
      (<var class="arg">carrier</var>, <var class="arg">ratio</var>, <var class="arg">index</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Returns a spectrum generated by <a href="http://en.wikipedia.org/wiki/Frequency_modulation_synthesis">Frequency Modulation</a> given a <var>carrier</var>  in hertz, a modulation <var>ratio</var> and an fm <var>index</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rm-spectrum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rm-spectrum</span>  (<var class="arg">freq1</var>, <var class="arg">freq2</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Returns a spectrum generated by <a href="http://en.wikipedia.org/wiki/Ring_modulation">ring modulation</a>, where <var>freq1</var> and <var>freq2</var> can be spectrum objects, lists of hertz values or single hertz values.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="import-spear-spectra">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">import-spear-frames</span>
      (<var class="arg">file</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Imports <a href="http://www.klingbeil.com/spear/">SPEAR</a> frame data in <var>file</var> as a list of spectrum objects.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="export-spear-spectra">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">export-spear-frames</span>
      (<var class="arg">spectra</var> <var class="arg">file</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Exports on or more spectrum objects in <var>spectra</var> to a file suitable for importing into <a href="http://www.klingbeil.com/spear/">SPEAR</a>. Since spectra do not have partials.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="spectrum-copy">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-copy</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Returns a copy of <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4>Accessing Spectral Information</h4>

<!-- DEFINITION -->
<table class="entry" id="spectrum-size">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-size</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; integer</td></tr>
</table>
<blockquote>
<p>
Returns the number of frequency and amplitude pairs in <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-time">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-time</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float or #f</td></tr>
</table>
<blockquote>
<p>
Returns the time of <var>spectrum</var> or false if there is none.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-maxfreq">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-maxfreq</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the highest frequency in <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-minfreq">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-minfreq</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the lowest frequency in <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-maxamp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-maxamp</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the highest amplitude in <var>spectrum</var> or 0.0 if there are no amplitudes.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-minamp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-minamp</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the lowest amplitude in <var>spectrum</var> or 0.0 if there are no amplitudes.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-freqs">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-freqs</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns the frequency values of <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-amps">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-amps</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns the amplitude values of <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-pairs">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-pairs</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list containing the frequencies and amplitudes of <var>spectrum</var> formatted as pairs: <code>(</code><var>f<sub>1</sub> a<sub>1</sub> ... f<sub>n</sub> a<sub>n</sub></var><code>)</code>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4>Modifying and Transforming Spectral Information</h4>

<!-- DEFINITION -->
<table class="entry" id="spectrum-keys">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-keys</span>
      (<var class="arg">spectrum</var>, <var class="opt">order</var> = <var class="optval">1</var>, <var class="opt">thresh</var> = <var class="optval">0.0</var>, <var class="opt">quant</var> = <var class="optval">#f</var>, <var class="opt">unique</var> = <var class="optval">#f</var>, <var class="opt">min</var> = <var class="optval">#f</var>, <var class="opt">max</var> = <var class="optval">#f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>

Returns a list of the frequency components of <var>spectrum</var>
converted to <a href="#key">keys</a>.

<var>Order</var> specifies the <a href="#scale-order">scale order</a>
the keys will be returned in.

<var>Threshold</var> specifies the minimum amplitude that frequencies
must possess in order to be returned as keys. If <var>threshold</var>
is a list <code>(</code><var>min</var> <var>max</var><code>)</code>
then components whose amplitudes are greater than max are also
suppressed.

If <var>quant</var> is a number between 0.0 and 1.0 then key values
are quantized to that fractional cent value, e.g. <var>quant</var> .5
returns key numbers quantized to the nearest quarter-tone and
<var>quant</var> 1 returns key numbers rounded to the nearest integer.

If <var>unique</var> is true then no duplicate key numbers will be returned.

If a <var>min</var> key is specified then spectral values lower than
that will be octave shifted upward until they equal or exceed
it.

If a <var>max</var> key is specified then spectral components above it
will be octave shifted downward until they are equal to or lower than
it.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-add_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-add!</span>
      (<var class="arg">spectrum</var>, <var class="arg">freq</var>, <var class="arg">amp</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Adds a pair of <var>freq</var> and <var>amp</var> values into <var>spectrum</var>. If <var>freq</var> already exists in <var>spectrum</var> then <var>amp</var> is added to its current amplitude.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<!--
<table class="entry" id="merge-spectra">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">merge-spectrum</span>
      (<var class="arg">spectrum</var>, <var class="rest">spectra...</var>)
    </td>
  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Merges <var>spectrum</var> with zero or more additional <var>spectra</var>. If <var>spectra</var> is null then a copy of <var>spectrum</var> is returned.
</p>
</blockquote>
-->
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="spectrum-flip_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-flip!</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; </td></tr>
</table>
<blockquote>
<p>

Inverts frequencies in <var>spectrum</var> while keeping the original min and max frequency boundaries the same.

</p>
</blockquote>
<!-- END DEFINITION -->




<!-- DEFINITION -->
<table class="entry" id="spectrum-rescale_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-rescale!</span>
      (<var class="arg">spectrum</var>, <var class="arg">mode</var>, <var class="arg">envelope</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-rescale!</span>
      (<var class="arg">spectrum</var>, <var class="arg">mode</var>, <var class="rest">xy...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-rescale!</span>
      (<var class="arg">spectrum</var>, <var class="arg">mode</var>, <var class="arg">y</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; spectrum</td></tr>
</table>
<blockquote>

<p>

Returns <var>spectrum</var> with its frequency or amplitude components
modified according to <var>mode</var> and an <var>envelope</var> of x
y values or a sequence of <var>xy...</var> values or a single
<var>y</var> value.

This modification encompasses both filtering and rescaling effects
applied to either the frequency or the amplitude side of the spectrum.
</p>

<p><var>Mode</var> is an integer (1-8) that specifies how
<var>spectrum</var> will be modified and its value depends on three
independent criteria:</p>

<ol>
<li>Will rescaling be applied to the frequency or the amplitude side of <var>spectrum</var>?</li>
<li>Is the x domain of <var>envelope</var> amplitude or frequency?</li>

<li>Will the y values in <var>envelope</var> be used as coefficients
or as (replacement) values?</li>

</ol>

<p> These three criteria produce 8 possible "modes" that identify the
following rescaling or filtering operations:</p>

<table cellspacing="5">
<tr><th class="lcol">Mode</th><th class="lcol">Domain modified</th> <th class="lcol">X domain of envelope</th> <th class="lcol">Y used as</th></tr>
<tr><td>1</td><td>frequency</td> <td>frequency</td> <td>value </td></tr>
<tr><td>2</td><td>frequency</td> <td>frequency</td> <td>scaler</td></tr>
<tr><td>3</td><td>frequency</td> <td>amplitude</td> <td>value</td></tr>
<tr><td>4</td><td>frequency</td> <td>amplitude</td> <td>scaler</td></tr>
<tr><td>5</td><td>amplitude</td> <td>frequency</td> <td>value</td></tr>
<tr><td>6</td><td>amplitude</td> <td>frequency</td> <td>scaler</td></tr>
<tr><td>7</td><td>amplitude</td> <td>amplitude</td> <td>value</td></tr>
<tr><td>8</td><td>amplitude</td> <td>amplitude</td> <td>scaler</td></tr>
</table>

<p>The table can be summarized as follows:</p>

<ul>
<li>Modes 1-4 modify the frequencies of the spectrum, modes 5-8 modify the amplitudes.</li>
<li>Odd numbered modes interpolate new values for the spectrum.</li>
<li>Even numbered modes interpolate coefficients to scale the spectrum.</li>
<li>Modes 3 4 use amplitude to modify frequency.</li>
<li>Modes 5 6 use frequency to modify amplitude.</li>
</ul>

<p>Envelope shortcuts:</p>
<ul>
  <li> Specify a single y value rather than an envelope to set or scale the spectrum by a constant value.</li>
  <li> Use <code>#t</code> as an x or y value to stand for the maximum frequency or amplitude (so you don't have to actually retrieve this value to use it).</li>
  <li> Use <code>#f</code> as an x or y value to stand for the minimum frequency or amplitude.</li>
</ul>

<dl>
  <dt>To shift frequencies downward by half:</dt>
  <dd><code>spectrum-rescale(spectrum, 2, .5)</code></dd>
  <dt>To low-pass a spectrum:</dt>
  <dd><code>spectrum-rescale(spectrum, 5, {100 1 400 .2 1000 .1})</code></dd>
  <dt>To invert the frequencies in a spectrum:</dt>
  <dd><code>spectrum-rescale(spectrum, 1, #f, #t, #t, #f)</code></dd>

</dl>

</blockquote>
<!-- END DEFINITION -->


<h3 id="files">File System</h3>

<!-- DEFINITION -->
<table class="entry" id="chdir">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">chdir</span> (<var class="arg">pathname</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Changes the current working directory to the <var>pathname</var> string.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="pwd">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pwd</span> ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; string</td></tr>
</table>
<blockquote>
<p>
Returns the full pathname string of the current working directory.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="directory">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">directory</span> (<var class="arg">spec</var>, [<var class="opt">recurse</var> <var class="optval">#f</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of absolute filenames matching wildcard <var>spec</var>. If <var>recurse</var> is true then subdirectories are recursively searched.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="shell">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shell</span>
      <var class="arg">command</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Calls operating system's shell interpreter to execute user's <var>command</var>.
</p>
</blockquote>

<h2 id="iteration">Iteration</h2>

<p>An (essentially) complete implementation of the <a href="http://www.lisp.org/HyperSpec/Body/sec_6-1.html">Common Lisp loop macro</a> is provided. </p>

<!-- DEFINITION -->
<table class="entry" id="loop">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">loop</span> [<a href="#with"><var class="arg">with-decl</var></a>] {<var class="arg">stepping</var>}* {<var class="arg">stopping</var>}* {<var class="arg">action</var>}+ [<var class="arg">finally</var>]
 <span class="commandname">end</span></td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr class="entry">
    <td class="formals">
      (<span class="funcname">loop</span> {<var>clause</var>}*)
    </td>
    <!-- td class="label">Scheme Macro</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; loop dependent value</td></tr>

<!-- END DEFINITION -->

</table>
<blockquote>
<p>

Defines an iteration. Optional local variables can be declared using the <a href="#with"><code>with</code></a> statement followed by zero or more <var>stepping</var> statements, zero or more <var>stopping</var> statements, one or more <var>action</var> statements, an optional <var>finally</var> statement and terminated with the required <code>end</code> tag.</p> 

<blockquote>
<table class= "float">
<tr><th colspan="2" class="lcol" style="padding-right: 1em">stepping statements</th></tr>
<tr><td><code><span class="reserved">repeat</span></code> <var>expr</var></td> <td> sets the iteration limit to <var>expr</var> </td> </tr>
<tr><td><code><span class="reserved">for</span></code> <var>var</var> <code><span class="reserved">=</span></code> <var>expr</var> [<code><span class="reserved">then</span></code> <var>expr2</var>]</td> <td> sets <var>var</var> to the value of <var>expr</var> on each iteration. If <code><span class="reserved">then</span></code> is specified <var>expr</var> is the initial value and <var>expr2</var> are the subsequent values</td></tr>
<tr><td><code><span class="reserved">for</span></code> <var>var</var> <code><span class="reserved">in</span></code> <var>expr</var></td> <td> increments <var>var</var> over elements the list <var>expr</var></td></tr>
<tr><td><code><span class="reserved">for</span></code> <var>var</var> [<code><span class="reserved">from</span></code> <var>expr</var>] [<code><span class="reserved">to</span> | <span class="reserved">below</span></code> <var>expr</var>] [<code><span class="reserved">by</span></code> <var>expr</var>]</td> <td> increments <var>var</var> from an on optional starting value to an ending value by an optional amount</td></tr>

<tr><th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em">stopping statements</th></tr>
<tr><td><code><span class="reserved">while</span></code> <var>expr</var></td> <td> iteration continues while <var>expr</var> is true</td> </tr>
<tr><td><code><span class="reserved">until</span></code> <var>expr</var></td> <td> iteration stops when <var>expr</var> is true</td> </tr>

<tr><th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em">conditional statements</th></tr>
<tr><td><code><span class="reserved">when</span></code> <var>expr</var></td> <td> action executed if <var>expr</var> is true</td> </tr>
<tr><td><code><span class="reserved">until</span></code> <var>expr</var></td> <td> action executed if <var>expr</var> is false</td> </tr>

<tr><th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em;">action statements</th></tr>
<tr><td> <span class="reserved">do</span>  <var>expr...</var></td> <td>  scheme expressions </td> </tr>
<tr><td> any SAL statement</td> <td>  SAL statements execute but do not return values </td> </tr>
<tr><th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em;">finally statements</th></tr>
<tr><td><code><span class="reserved">finally</span></code> <var>statement</var></td> <td>executes <var>statement</var> as soon as iteration has completed</td></tr>


</table>
</blockquote>

</blockquote>







<h2 id="audio">Audio</h2>

<h3 id="sendingaudio">Sending Audio Data</h3>

<p>Every audio target implements a set of <var>methods</var> that you
can send data to.  This routing is accomplished  using <a
 href="send">send</a> or by calling the underlying message
functions directly.</p>

<!-- DEFINITION -->
<table class="entry" id="send">

  <tr class="entry">
    <td class="formals">
      <span class="commandname">send</span>
      <span class="string">"<var class="arg">target</var>:<var class="arg">method</var>"</span>, <var class="rest">data...</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      (<span class="funcname">send</span>
      <span class="string">"<var class="arg">target</var>:<var class="arg">method</var>"</span> <var class="rest">data...</var>)
    </td>
    <!-- td class="label">Scheme Macro</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
The first argument to <code>send</code> is its <var>message</var>, a
literal string or symbol in the format <var>target</var><span
style="font-weight: bold;">:</span><var>method</var> that identifies a
specific audio resource and a method to receive the <var>data</var> you pass to it.
</p>

<p> Note that each send message is implemented by a Scheme function
with the same name that can be called directly to achieve the same
effect. The difference between using a send message and calling the
underlying message function is (1) for some messages the send macro can
perform argument testing at eval time rather
than run time and (2) using send makes it very clear that the code is
sending audio information. </p>


</blockquote>
<!-- END DEFINITION -->

<!--
<h4>Example</h4>

<div class="float">
<p><strong>SAL</strong></p>
<pre class="code">
<span class="command">send</span> <span class="string">"mp:midi"</span>, <span class="keyword">key:</span> 70
<span class="command">send</span> <span class="string">"mp:midi"</span>, 0, 1, 60, .1, 0
<span class="command">send</span> <span class="string">"mp:midi"</span>, 0, 1, <span class="keyword">key:</span> 60, <span class="keyword">chan:</span> 10
<span class="command">send</span> <span class="string">"mp:midi"</span>, <span class="keyword">chan:</span> 10, <span class="keyword">time:</span> 2, <span class="keyword">key:</span> 60
</pre>
</div>

<div class="float">
<p><strong>Scheme</strong></p>
<pre class="code">
(send <span class="string">"mp:midi"</span> <span class="keyword">key:</span> 70)
(send <span class="string">"mp:midi"</span> 0 1 60 .1 0)
(send <span class="string">"mp:midi"</span> 0 1 <span class="keyword">key:</span> 60 <span class="keyword">chan:</span> 10)
(send <span class="string">"mp:midi"</span> <span class="keyword">chan:</span> 10 <span class="keyword">time:</span> 2 <span class="keyword">key:</span> 60)
</pre>
</div>
-->

<h3 id="midi-out">Midi Out</h3>

<p>Before sending anything to the Midi Out port select use the <span
class="menuitem">Audio&gt;Midi Out&gt;</span> menu to select an output device. You can test that the connection actually works by using the
<span class="menuitem">Ports&gt;Midi Out&gt;Test</span> to send a
random burst of messages to the output device.</p>

<h4>Midi Out Messages</h4>

<!-- DEFINITION -->
<table id="mp:midi" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">send</span> <span class="string">"mp:midi"</span>, <var class="optkey">time</var> <var class="optval">= 0</var>, <var class="optkey">dur</var> <var class="optval"> = .5</var>, <var class="optkey">key</var> <var class="optval"> = 60</var>, <var class="optkey">amp</var> <var class="optval"> = .5</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
    
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Send note data to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:on"  class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">send</span>
      <span class="string">"mp:on"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">key</var> <var class="optval"> = 60</var>, <var class="optkey">amp</var> <var class="optval"> = .5</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Send note on data to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:off">
  <tr class="entry">
    <td class="formals"><span class="commandname">send</span>
      <span class="string">"mp:off"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">key</var> <var class="optval"> = 60</var>, <var class="optkey">vel</var> <var class="optval"> = 127</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote><p>Sends note off data to midi port.</p></blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:prog" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">send</span>
      <span class="string">"mp:prog"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">val</var> <var class="optval"> = 0</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote><p>Sends program change value to midi port. </p></blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:instruments" class="entry">
  <tr class="entry">
    <td class="formals"><span class="commandname">send</span>
      <span class="string">"mp:instruments"</span>, <var class="arg">pc</var><var class="rest">...</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Sends up to sixteen program changes out the Midi port and updates the port's instrument table. The position of each value specifies the channel it is sent to, ie the first program change is sent to channel 0 and so on. To skip a particular channel provide #f as its program change value.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:ctrl" class="entry">
  <tr class="entry">
    <td class="formals"><span class="commandname">send</span> <span class="string">"mp:ctrl"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">num</var> <var class="optval"> = 0</var>, <var class="optkey">val</var> <var class="optval"> = 0</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote><p>Sends control change data to midi port.</p></blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:touch" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">send</span>
      <span class="string">"mp:touch"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">val</var> <var class="optval"> = 0</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sends after touch value to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry">
  <tr class="entry">
    <td id="mp:press" class="formals"><span class="commandname">send</span>
      <span class="string">"mp:press"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">val</var> <var class="optval"> = 0</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sends channel pressure value to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry">
  <tr class="entry">
    <td id="mp:bend" class="formals"><span class="commandname">send</span>
      <span class="string">"mp:bend"</span>, <var class="optkey">time</var> <var class="optval"> = 0</var>, <var class="optkey">val</var> <var class="optval"> = 8192</var>, <var class="optkey">chan</var> <var class="optval"> = 0</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Sends pitch bend value 0-16383 to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4 id="midi_options">Midi Out File Options</h4>

<p>Midi files can be written, no midifile options are implemented.</p>


<h3 id="midi-in">Midi In</h3>


<!-- DEFINITION -->
<table id="mp:inhook" class="entry">
  <tr class="entry"> <td class="formals"><span class="commandname">send</span> <span class="string">"mp:inhook"</span>, <var class="arg">function</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sets <var>function</var> to receive midi input data as soon at it arrives at the Midi In port<!--, or clears (removes) the existing hook if <var>function</var> is <code>#f</code> -->. A hook function must accept four values:
</p>

<dl>
  <dt><var>opcode</var></dt>
  <dd>The incoming message's MIDI opcode, #x8 to #xE. These opcodes are available as named constants: <code>mm:off</code>, <code>mm:on</code>, <code>mm:touch</code>, <code>mm:ctrl</code>, <code>mm:prog</code>, <code>mm:press</code>, <code>mm:bend</code>.</dd>
  <dt><var>channel</var></dt>
  <dd>The message's channel value, 0 to 15.</dd>
  <dt><var>data1</var></dt>
  <dd>The message's first data byte value, 0 to 127.</dd>
  <dt><var>data2</var></dt>
  <dd>The message's second data byte value, 0 to 127. This will be 0 if the message does not have a second data byte.</dd>
</dl>

<p>To clear an existing hook specify <code>#f</code> as the value
of <var>function</var>. (If an error occurs during a hook's execution
the hook will be cleared automatically.)</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:inchans" class="entry">
  <tr class="entry">
    <td class="formals"><span class="commandname">send</span>
      <span class="string">"mp:inchans"</span>, <var class="arg">chan ...</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Enables MIDI input only on the specified channels. Channel values are integers between 0 and 15. Specify a single <code>#t</code> value to enable all channels and <code>#f</code> to disable all channels.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:inops" class="entry">
  <tr class="entry">
    <td class="formals"><span class="commandname">send</span>
      <span class="string">"mp:inops"</span>, <var class="arg">opcode ...</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Enables MIDI input only for the specified MIDI opcodes. Opcodes are integers between #x8 and #xE (<code>mm:off mm:on mm:touch mm:ctrl mm:prog mm:press mm:bend</code>). Specify a single <code>#t</code> to enable all opcode types and <code>#f</code> to disable all opcodes.
</p>
</blockquote>
<!-- END DEFINITION -->


<h3 id="sndlib">SndLib</h3>

<p>If CM has been built with SndLib/S7 then SndLib audio instruments
are available.  Use <span
class="menuitem">Audio&gt;SndLib&gt;Instruments...</span> to load
instruments before working with them. </p>

<h4>SndLib Messages</h4>

<p>To send data to a SndLib instrument specify the instrument name as
a <a href="#send">send</a> message or call the instrument functions
directly. For example, the following calls are all equivalent:</p>

<div class="float">
  <pre class="code">
<span class="command">send</span> <span class="string">"wave"</span>, 0, 1, 440, .1
(send <span class="string">"wave"</span> 0 1 440 .1)
(wave 0 1 440 .1)
</pre>
</div>

<h4 id="sndlib_options">SndLib Audio File Options</h4>
<p>
Any CLM <a href="http://ccrma.stanford.edu/software/snd/snd/sndscm.html#withsound">with-sound</a> option can be passed as an argument to <a href="#sprout">sprout</a> when you generate an audio file. The most common options are listed here and are also available in the <span class="menuitem">Audio&gt;SndLib&gt;</span> menu.
</p>

<dl>
  <dt><code><span class="keyword">srate:</span></code></dt>
  <dd>The sampling rate to use.</dd>
  <dt><code><span class="keyword">channels:</span></code></dt>
  <dd>The number of audio channels to write.</dd>
  <dt><code><span class="keyword">play:</span></code></dt>
  <dd>Play the audio file after writing it.</dd>
</dl>  


<h3 id="csound">Csound</h3>

<p>Csound score files can be written and played in all versions of CM. Use the <span
class="menuitem">Audio&gt;Csound&gt;Settings...</span> dialog to
configure the Csound environment, or pass the options directly to the
scorefile when you generate it with <a href="#sprout">sprout</a>.
</p>

<h4 id="csound_messages">Csound Messages</h4>

<p> To send data to Csound use the messages listed below or call the
 underlying message functions directly. For example, the following
 calls are all equivalent:</p>

<div class="float">
  <pre class="code">
<span class="command">send</span> <span class="string">"cs:i"</span>, 1, 0, 1, 440, 1000
(send <span class="string">"cs:i"</span> 1 0 1 440 1000)
(cs:i 1 0 1 440 1000)
</pre>
</div>

<!-- DEFINITION -->
<table id="cs:i" class="entry">
  <tr class="entry"> <td class="formals"><span class="commandname">send</span> <span class="string">"cs:i"</span>, <var class="arg">ins</var>, <var class="arg">start</var>, <var class="arg">dur</var> <var class="rest">...</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sends instrument data to Csound.  The first value should be the instrument's number followed by the rest of its pfield values.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="cs:f" class="entry">
  <tr class="entry"> <td class="formals"><span class="commandname">send</span> <span class="string">"cs:f"</span>, <var class="arg">num</var> <var class="rest">...</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Sends function table data to Csound. Similar to <span class="string">"cs:i"</span> in all other respects.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="cs:data" class="entry">
  <tr class="entry"> <td class="formals"><span class="commandname">send</span> <span class="string">"cs:data"</span>, <var class="arg">list</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Sends a <var>list</var> of data to Csound. The first element in the list must be the symbol <code>i</code> or <code>f</code>. Similar to <span class="string">"cs:i"</span> and <span class="string">"cs:f"</span> in all other respects.

</p>
</blockquote>
<!-- END DEFINITION -->


<h4 id="csound_options">Csound Scorefile Options</h4>

<p> The following scorefile options are available in the <span
class="menuitem">Audio&gt;Csound&gt;</span> menu and can be passed to
Csound scores when you generate them using <a
 href="#sprout">sprout</a> .  </p>

<dl>

  <dt><code><span class="keyword">play:</span></code></dt>

  <dd>Send the scorefile to Csound after it is written.</dd>

  <dt><code><span class="keyword">orchestra:</span></code></dt>

  <dd>Use this file as the Csound .orc file when the scorefile is played.</dd>

  <dt><code><span class="keyword">header:</span></code></dt>

  <dd>Include this string as the header of the scorefile.</dd>

  <dt><code><span class="keyword">write:</span></code></dt>

  <dd>Specify #f to put data in an internal score without writing it
  as a file. This lets you build a score incrementally, over
  consecutive sprouts, and to export score data to an editor window
  or the clipboard.</dd>

</dl>  


<!--
<h3 id="plotter-port">Plotter Port Methods</h3>
<p>Routes data to the focus layer of the current plotter window. (Not yet implemented.)</p>
-->

<h2 id="scheduler">The Scheduler</h2>

<!-- p>The scheduler is a JUCE thread that executes on a 1 millisecond
tick for real time scheduling and as fast as possible for file-based sheduling.</p -->

<p>The main entry point into the scheduler is called <a
 href="sprout">sprout</a>.  Sprout schedules algorithms to run in real
time, or faster than real time if a file (string) is specified as an
argument to the function.
</p>

<table id="sprout" class="entry">
  <tr class="entry">
    <td class="formals"> <span class="commandname">sprout</span> <var class="arg">process</var>, [<var class="opt">ahead</var> <var class="optval">0</var>], [<var class="opt">id</var> <var class="optval">#f</var>]</td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr class="entry">
    <td class="formals"> <span class="commandname">sprout</span> <var class="optkey">process</var>, [<var class="opt">ahead</var> <var class="optval">0</var>], <var class="arg">file</var>, <var class="rest">options... </var></td>
    <!-- td class="label">SAL</td -->
  </tr>


  <tr><td class="retval" colspan="2">&rarr; void</td> </tr>
</table>

<blockquote>


<h5> Real Time</h5>

<p>Adds <a href="#processes"><var>process</var></a> to the scheduler
starting at <var>ahead</var> time from now. If <var>id</var> is
provided it tags the process in the scheduling queue; tagged processes
can then be selectively removed from the scheduler using <a
 href="#stop"><code>stop</code></a>. The <var>process</var> parameter
can be a single process or list of processes. If it is a list then
<var>ahead</var> and <var>id</var> can also be lists and their values
are paired with each process in left-to-right order. See <a
 href="#processes">Musical Processes</a> for more information.  </p>


<h5> File Output</h5>

<p>Adds <a href="#processes"><var>process</var></a> to the scheduler
starting at <var>ahead</var> time from now. <var>File</var> is the file to write the data to, and must include a supported file extension. CM currently supports the following file types:
</p>

<ul>
  <li><code><span class="string">".mid"</span></code> midi file.</li>
  <li><code><span class="string">".wav"</span></code> audio file using SndLib.</li>
  <li><code><span class="string">".aiff"</span></code> audio file using SndLib.</li>
  <li><code><span class="string">".snd"</span></code> audio file using SndLib.</li>
  <li><code><span class="string">".sco"</span></code> Csound score file.</li>
</ul>

<p><var>Options...</var> is zero or more keyword options suitable for the audio target selected by <var>file</var>:</p>

<ul>
  <li><a href="#midi_options">Midi options</a></li>
  <li><a href="#sndlib_options">SndLib options</a></li>
  <li><a href="#csound_options">Csound options</a></li>
</ul>

<p>Note that when an algorithm sends data to a file it should probably
use the true score time as the time stamp fror the data, see <a
 href="#elapsed">elapsed</a> for more information about this.</p>


</blockquote>

<table class="entry" id="stop">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">stop</span>
      (<var class="rest">id...</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2"> &rarr; void</td></tr>
</table>

<blockquote>
<p>
Stops processes currently running in the scheduling queue. If no ids
are given all the processes are stopped and any pending events in the
midi output queue are also flushed. Otherwise only processes with the
specified ids are stopped. Note that multiple processes can share a
common id, in which cases all the processes with that id are stopped.
</p>
</blockquote>

<blockquote>
<p>
Stops all processes that are currently running and flushes any pending events in the output queue.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="pause">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pause</span>
      ()
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Suspends the process scheduler.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="cont">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">cont</span>
      ()
    </td>
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Resumes (continues) the paused scheduler.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="now">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">now</span>
      ()
    </td>
  </tr>
  <tr><td class="retval" colspan="2">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the current time of the scheduler. See also <a href="#elapsed"><code>elapsed</code></a>
</p>
</blockquote>
<!-- END DEFINITION -->

<h2 id="plotting">Plotting</h2>

<p>Plotting windows support graphic display, editing and audio playback of
multi-dimensional data sets. To create a new plot, to open an existing
plot file (.xml) or a Midi file use the plotting commands in the
Console's <span class="menuitem">File</span> menu.</p>

<p>For any plotting window:</p>
<ul>
  <li>To add new points: Control-click</li>
  <li>To select points: Click on point or click-drag region</li>
  <li>To delete points: Delete key</li>
  <li>To edit layer properties: Double-click background</li>
  <li>To zoom axis: Click drag on axis ruler</li>
  <li>To edit axis properties: Double-click on axis ruler.</li>
  <li>To play a plot: Select <span class="menuitem">Audio&gt;Play Plot...</span> in the Plot window's menubar</li>

</ul>

<p>The following functions are provided for working with plots in code. Use <span class="menuitem">Help&gt;Examples&gt;Plotting</span> to open various examples of coding plots in an Editor window.
</p>

<!-- DEFINITION< -->
<table class="entry" id="plot">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plot</span>
      (<var class="rest">settings...</var> {<var class="arg">pointlist</var> <var class="rest">settings...</var>}<var class="rest">...</var>)
    </td>
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Creates a new plot given zero or more global plot settings followed by
 optional layers of plotting data with layer-specific settings. Each
 <var>pointlist</var> is a list in one of the following formats:

</p>

<dl>
  <dt><code>(</code> <code>(</code><var>c1</var> <var>c2</var> <var>...</var> <var>cn</var><code>)</code> <var>...</var><code>)</code></dt>
<dd>A list of lists where each sublist defines the data <a href="#fields">fields</a> of a point record.</dd>

<dt><code>(</code><var>x1</var> <var>y1</var> <var>x2</var> <var>y2</var> <var>...</var> <var>xn</var> <var>yn</var><code>)</code></dt>
<dd>A flat list of <var>x</var> <var>y</var> point data.</dd>

<dt><code>(</code><var>v1</var> <var>v2</var> <var>...</var>
<var>vn</var><code>)</code></dt> <dd>A flat list of values to parse in conjunction with the  <a href="#values">values:</a> setting below.</dd>
</dl>

<p>
A <var>setting</var> is a plotting keyword followed by its value. In
general, setting values can be specified as symbols, keywords or
strings. Settings that appear before the first point list are treated
as <em>global settings</em>, ie they apply to the window and/or to all
the point lists.  Settings specified after a point list apply only to
that layer of points.</p>

<p><code class="entry">plot</code> supports following settings:</p>

<dl>

  <dt id="title"><span class="keyword"><code>title:</code></span> <var>string</var></dt>
  <dd>Specifies the window title or the title of the point layer if it appears after a point list.</dd>
  
  <dt id="xaxis"><span class="keyword"><code>xaxis:</code></span> {<var>type</var> | (<var>type from to by ticks</var>)}</dt>
  <dd> Specifies the horizontal axis type and (optionally) its characteristics. 
    
    <blockquote>
    <table class="float" width="50%">
      <caption>Available axis types and their default characteristics</caption>
      <tr><th class="lcol">type</th> <th class="lcol">from</th> <th class="lcol">to</th><th class="lcol">by</th><th class="lcol">ticks</th></tr>
      <tr><td><code>unit</code>   </td><td> 0  </td><td> 1      </td><td> .25 </td><td> 5 </td></tr>
      <tr><td><code>percent</code></td><td> 0  </td><td> 100    </td><td> 25  </td><td> 5 </td></tr>
      <tr><td><code>keynum</code> </td><td >0  </td><td> 127    </td><td> 12  </td><td> 1 </td></tr>  
      <tr><td><code>seconds</code></td><td> 0  </td><td> 60     </td><td> 1   </td><td> 4 </td></tr>
      <tr><td><code>ordinal</code></td><td> 0  </td><td> length </td><td> 1   </td><td> 1 </td></tr>
      <tr><td><code>circle</code> </td><td> -1 </td><td> 1      </td><td> .25 </td><td> 4 </td></tr>
    </table>
    </blockquote>

    See the <a href="#fields">fields:</a> setting for complete control over record fields and axes.
    
  </dd>
  
  <dt id="yaxis"><span class="keyword"><code>yaxis:</code></span> {<var>type</var> | (<var>type from to by ticks</var>)}</dt>
  <dd> Specifies the vertical axis type and (optionally) its characteristics.
  
    See the <a href="#fields">fields:</a> setting for complete control over record fields and axes.

  </dd>
  
  <dt id="color"><span class="keyword"><code>color:</code></span> {<var>name</var> | <var>"rgb"</var>}</dt>
  <dd>The color for drawing the specified plot list.</dd>

  <dt id="style"><span class="keyword"><code>style:</code></span> {<var>name</var>}</dt>
  <dd>The style for drawing point records.
    <ul>
      <li> <code> envelope</code> (points connected by lines) </li>
      <li>  <code>line</code> (lines only) </li>
      <li>  <code>point</code> (points only) </li>
      <li>  <code>hbox</code> (horizontal boxes, requires 3 fields of data) </li>
      <li>  <code>impulse</code> (vertical lines) </li>
      <li>  <code>histogram</code> (vertical lines with points) </li>
    </ul>
  </dd>  
  
    <dt id="fields"><span class="keyword"><code>fields:</code></span>
  ((<var>field1 axisinfo...</var>)(<var>field2 axisinfo...</var>) <var>...</var>)</dt>
  <dd>
Provides full control over the interpretation of the data fields in
 point records.  The left to right order of fields corresponds to the
  left-to-right values in the point records. <var>Name</var> is the name of the field in the record and
    <var>axisinfo</var> is its axis information as described in the  <a
  href="#xaxis">xaxis</a>  and <a href="#yaxis">yaxis</a> settings above. To
  force field to share the axis of a (leftward) field specify the name of that field as the axisinfo.</dd>


  <dt id="values"><span class="keyword"><code>values:</code></span> {<var>int</var> | <code>y</code>}</dt>
  <dd>Specifies how to parse non-standard point
  lists, i.e. flat lists containing only y data or flat lists in which
  each series of <var>int</var> values should become a single
  point.</dd>

</dl>

</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION --> <table class="entry" id="plot-data"> <tr
class="entry"> <td class="formals"> <span
class="funcname">plot-data</span> (<var class="arg">title</var> [<var
class="arg">all</var> #t]) </td> </tr> <tr><td class="retval"
colspan="2">&rarr; list</td></tr> </table> <blockquote> <p> Returns
the point data from the plot window whose <var>title</var> is
specified. If <var>all</var> is false then only the points in the
topmost (focus) layer will be returned otherwise all layer data will be
returned.  </p> </blockquote>
<!-- END DEFINITION -->


<h2 id="sal">SAL</h2>

<h3 id="expressions">Expressions</h3>

<dl>

<dt id="sal:numbers">Numbers</dt>
<dd>
  <p>Integers and floats (no ratios yet...)</p>
</dd>

<dt id="sal:arithmetic">Arithmetic and Logical Expressions</dt>

<dd><p>Arithmetic and logical expressions are infix.  Operators must be delimited from their operands using spaces and/or parentheses. In other words, 2 + 4 is addition and 2+4 is nothing. Standard operator
precedence rules apply if no parentheses are provided. The following operators are defined:
</p>
<table id="sal:operators" class= "float">
<tr><th class="lcol" style="padding-right: 1em;">operator</th><th class="lcol">meaning</th></tr>
<tr><td><code>  + </code></td><td>  addition  </td></tr>  
<tr><td><code>  - </code></td><td>  subtraction  </td></tr>  
<tr><td><code>  * </code></td><td>  multiplication  </td></tr>  
<tr><td><code>  / </code></td><td>  division  </td></tr>
<tr><td><code>  % </code></td><td>  modulus (remainder after division)  </td></tr>
<tr><td><code>  ^ </code></td><td>  exponentiation  </td></tr>
<tr><td><code>  = </code></td><td>  equal  </td></tr>
<tr><td><code>  != </code></td><td> not equal  </td></tr>
<tr><td><code>  &gt; </code></td><td>  greater than  </td></tr>
<tr><td><code>  &lt; </code></td><td>  less than  </td></tr>
<tr><td><code>  &gt;= </code></td><td> greater than or equal  </td></tr>
<tr><td><code>  &lt;= </code></td><td> less than or equal  </td></tr>
<tr><td><code>  ~= </code></td><td> general equality  </td></tr>
<tr><td><code>  &amp;  </code></td><td> logical and   </td></tr>
<tr><td><code>  |  </code></td><td> logical or  </td></tr>
<tr><td><code>  !  </code></td><td> logical not  </td></tr>
</table>
<p></p>
</dd>

<dt id="sal:conditionals">Booleans</dt>
<dd><p><code><span class="constant">#t</span></code> is boolean true and <code><span class="constant">#f</span></code> is boolean false.</p>
</dd>

<dt id="sal:conditional-values">Conditional Values</dt>
<dd><p><code><span class="salcon">#?</span> (<var class="arg">test</var>,  <var class="arg">true</var> [<code>,</code> <var class="arg">false</var>])</code></p>
</dd>

<dt id="sal:strings">Strings</dt>
<dd><p>A string of uninterpreted characters enclosed within <code><span class="string">""</span></code>.</p>
</dd>  

<dt id="sal:symbols">Symbols</dt>
<dd><p>Alphanumeric names for variables, functions, etc.</p>
</dd>

<dt id="sal:keywords">Keywords</dt>
<dd>

 <p> <code><span class="constant">#:<var class="arg">symbol</var></span></code>     </p>

</dd>

<dt id="sal:lists">Lists</dt>
<dd><p>Sequences of constant data enclosed within <code>{}</code>. Lists may contain numbers, booleans, symbols, strings, and other lists. Quasi-quotation in constant lists is supported. Use <code><span class="constant">#$</span></code> to unquote and <code><span class="constant">#^</span></code> to unquote-splice.</p>
</dd>

<!-- dt id="slot_ref">Slot value references</dt>
<dd><p>A variable reference <var>vvv</var>.<var>sss</var> where <var>vvv</var> is the name of the variable and <var>sss</var> is the name of a slot. Slot value references can appear in expressions and values can be assigned to slots by the <a href="#set">set</a> statement.</p></dd -->

<dt id="sal:array">Vector notation</dt>
<dd>
  <p>A variable identifier followed by an index enclosed within <code>[]</code>.</p>
</dd>

<dt id="sal:funcall">Function call notation</dt>
<dd><p>A function name followed by zero or more comma-delimited arguments enclosed within <code>()</code>. Several different types of parameters are supported:
</p>

<dl >
<dt id="sal:required-parameters">Required parameters</dt>
<dd>Required parameters must be specified. A required parameter appears in the function definition documentation as <var class="arg">parameter</var>.</dd>

<dt id="sal:optional-parameters">Optional parameters</dt>
<dd>Optional parameters may be specified or not.  If not they receive a default value, which is false if not otherwise indicated.  An optional parameter is shown in the function definition documentation as <code>[<var class="arg">parameter</var> <var class="optval">value</var>]</code></dd>

<dt id="sal:optkey-parameters">Opt/key parameters</dt>
<dd>Opt/key parameters are optional parameters that can be specified either positionally or by preceding the value by the keyword name of the parameter (the name of the parameter with a colon at the end.) For example if a function <code>foo</code> has two opt/key parameters named <var>a</var> and <var>b</var> then it could be called in any of the following ways: <code>(foo) (foo 4) (foo 2 3)  (foo a: 3) (foo b: 99) (foo a: 2 b: 4)  (foo b: 99 a: 2)</code>   
An opt/key parameter is shown in the documentation as <var class="optkey">parameter</var> <var class="optval"> = value</var>
</dd>
<dt id="sal:variable-parameters">Variable parameters</dt>
<dd>Variable parameters may be specified zero or more times.  A variable parameter is shown in the function definition documentation as <code><var class="rest">parameter...</var></code> where  <var>...</var> means "the rest of the arguments".
<p></p>
</dd>
</dl>
</dd>
</dl>

<h3 id="assignment">Assignment</h3>


<!-- DEFINITION -->
<table class="entry" id="set">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">set</span> <var class="arg">variable</var> <var class="arg">op</var> <var class="arg">value</var> {<code>,</code> <var class="arg">variable</var> <var class="arg">op</var> <var class="arg">value</var>}*</td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Assigns each <var>variable</var> to <var>value</var> according to the assignment operator <var>op</var>:

</p>

<blockquote>
<table class= "float">
<tr><th class="lcol" style="padding-right: 1em;">operator</th><th class="lcol">meaning</th></tr>
<tr><td><code>=</code></td> <td> set <var>variable</var> to <var>value</var> </td> </tr>
<tr><td><code>+=</code></td> <td> increment <var>variable</var> by <var>value</var> </td> </tr>
<tr><td><code>*=</code></td> <td> scale <var>variable</var> by <var>value</var> </td> </tr>
<tr><td><code>&amp;=</code></td> <td> concatenate <var>value</var> onto the end of the list in <var>variable</var> </td> </tr>
<tr><td><code>^=</code></td> <td> splice the list <var>value</var> onto the end of the list in <var>variable</var> </td> </tr>
<tr><td><code>@=</code></td> <td> concatenate <var>value</var> onto the front of the list in <var>variable</var> </td> </tr>
<tr><td><code>&lt;=</code></td> <td> minimize <var>variable</var> with respect to <var>value</var> </td> </tr>
<tr><td><code>&gt;=</code></td> <td> maximize <var>variable</var> with respect to <var>value</var> </td> </tr>
</table>
</blockquote>
</blockquote>
<!-- END DEFINITION -->

<h3 id="conditionals">Conditionals</h3>

<!-- DEFINITION -->
<table class="entry" id="if">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">if</span>
      <var class="arg">test</var> <span class="reserved">then</span> [<var class="arg">true</var>] [<span class="reserved">else</span> <var class="arg">false</var>]
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
If <var>test</var> is true execute <var>true</var> statement otherwise execute an optional <var>false</var> statement. See also: <a href="#condval">conditional value</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="when">
    <tr class="entry">
    <td class="formals">
      <span class="commandname">when</span>
      <var class="arg">test</var> <var class="arg">statement</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Execute <var>statement</var> if <var>test</var> is true.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="unless">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">unless</span>
      <var class="arg">test</var> <var class="arg">statement</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Execute <var>statement</var> if <var>test</var> is false.
</p>
</blockquote>
<!-- END DEFINITION -->



<h3 id="sequencing">Sequencing</h3>

<!-- DEFINITION -->
<table class="entry" id="begin">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">begin</span> [<a href="#with"><var class="arg">with-decl</var></a>] {<var class="arg">statement</var>}+ <span class="commandname">end</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Sequences one or more SAL statements as a single statement.  <var>With-decl</var> is an optional local variable declaration that can appear at the start of block statements like <a href="#begin"><code>begin</code></a>, <a href="#loop"><code>loop</code></a> and <a href="#run"><code>run</code></a>:
</p>


<!-- DEFINITION -->
<table class="entry" id="with">
  <tr class="entry">
    <td class="formals">
      <span class="reserved">with</span> <var class="arg">var</var> [= <var class="arg">value</var>] {, <var class="arg">var</var> = <var class="arg">value</var>]}*
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Declares one or more comma-delimited variables and sets them to an optional initial value or to false if no value is specified. 
</p>
</blockquote>
</blockquote>
<!-- DEFINITION -->

<h3 id="definitions">Definitions</h3>

<h4 id="variables">Variables</h4>

<!-- DEFINITION -->
<table class="entry" id="define-variable">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">define</span> <span class="class">variable</span>
<var class="arg">symbol</var> [= <var class="arg">value</var>] {, <var class="arg">symbol</var> [= <var class="arg">value</var>]}*
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p> Defines <var>symbol</var> to  <var>value</var> or to false if <var>value</var> is not provided. More than one variable can be defined in the statement by using commas to delimit each variable declaration.
</p>

</blockquote>
<!-- END DEFINITION -->

<h4 id="functions">Functions</h4>

<!-- DEFINITION -->
<table class="entry" id="define-function">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">define</span> <span class="class"> function</span> <var class="arg">name</var> ({<var class="arg">parameter</var>}*) {<var class="arg">statement</var>}
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
A function definition consists of the <var>name</var> of the function,
a series of zero or more <var>parameters</var> (input variables)
enclosed within <code>()</code> and followed by a single statement
which will be executed when the function is called.

Use a <a href="#begin"><code>begin</code></a> block to declare local
variables inside the function or to execute more than one statement as
the body of the function.

Values passed into the function will be available in the corresponding
<var>parameter</var>. To define a function that accepts a variable
number of arguments append <code>...</code> to the name of the last
<var>parameter</var>.  This will cause that parameter to receive the
remainder of the arguments as a list of values.

Use the <a href="#return"><code>return</code></a> statement to return a value from the function:</p>

</blockquote>

<!-- DEFINITION -->
<table class="entry" id="return">
  <tr class="entry">
    <td class="formals">
      <span class="reserved">return</span> <var class="arg">value</var></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; value</td></tr>
</table>
<blockquote>
<p>
Causes the function to evaluate to <var>value</var>.
</p>
</blockquote>

<!-- DEFINITION -->

<h4 id="processes">Processes</h4>
<p>
Processes are functions you <a href="#sprout"> <code>sprout</code></a> into the scheduler to execute. In SAL you create a process using the <a href="defprocess">define process</a> command. In Scheme you create a process using the <a href="#run">process</a> macro. The following two example are equivalent:
</p>

<div class="float">
<pre class="code">
<span class="command">define</span> <span class="class">process</span> simp (reps, rate, low, hi)
  <span class="reserved">run</span> <span class="reserved">repeat</span> reps
      <span class="reserved">send</span> <span class="string">"mp:midi"</span>, <span class="keyword">key:</span> between(low, hi)
      <span class="reserved">wait</span> rate
  <span class="reserved">end</span>

(<span class="command">define</span> (simp reps rate low hi)
  (<span class="reserved">process</span> <span class="reserved">repeat</span> reps
           <span class="reserved">do</span>
           (send <span class="string">"mp:midi"</span> <span class="keyword">:key</span> (between low hi))
           (wait rate)))
</pre>
</div>


<!-- DEFINITION -->
<table class="entry" id="defprocess">
    <tr class="entry">
    <td class="formals">
       <span class="commandname">define</span> <span class="class">process</span> <var class="arg">name</var> ({<var class="arg">parameter</var>}*) {<var class="arg">statement</var>}*  <a href="#run"><span class="reserved">run</span></a> {<var class="arg">clause</var>}+ <span class="reserved">end</span>  
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Defines a function that executes in the scheduler. The definition must contain a <a href="#run"> run</a> statement.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="run">
  <tr class="entry">
    <td class="formals"><span class="commandname">run</span>
      [<a href="#with"><var class="arg">with-decl</var></a>] {<var class="arg">stepping</var>}* {<var class="arg">stopping</var>}* {<var class="arg">statement</var>}+ [<var class="arg">finally</var>]
      <span class="commandname">end</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      (<span class="funcname">process</span> {<var class="arg">clause</var>}+)
    </td>
    <!-- td class="label">Scheme Macro</td -->
  </tr>

  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>Identical to <a href="#iteration">loop</a> in almost all respects but iteration is managed by the <a href="#scheduler">scheduler</a>. </p>
</blockquote>

<!-- DEFINITION -->
<table class="entry" id="wait">
  <tr class="entry">
    <td class="formals"><span class="commandname">wait</span>
      <var class="arg">time</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr class="entry">
    <td class="formals"><span class="funcname">wait</span> (<var class="arg">time</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  

  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Causes the process to wait <var>time</var> seconds before the next iteration. To stop the process provide negative <var>time</var> value. This function only exists within the lexical scope of a process definition.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="elapsed">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">elapsed</span> ([<var class="opt">scoretime?</var> <var class="optval">#f</var>])
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the amount of time since the process was first sprouted, or the true (absolute) score time if the optional <var>scoretime</var> argument is <code>#t</code> This function only exists within the lexical scope of a process definition.
</p>
</blockquote>
<!-- END DEFINITION -->


<h3 id="environment">Environment</h3>



<!-- DEFINITION -->
<table class="entry" id="print">
 <tr class="entry">
    <td class="formals">
      <span class="commandname">print</span>
     <a href="#expressions"><var class="arg">expr</var></a> {, <a href="#expressions"><var class="arg">expr</var></a>}*
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p> Prints the value of one or more comma delimited <a href="#expressions"><var>exprs</var></a> to the Console window.</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="exec">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">exec</span>
      <a href="#expressions"><var class="arg">expr</var></a> {, <a href="#expressions">expr<var class="arg"></var></a>}*
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Executes one or more comma-delimited <a href="#expressions"><var>exprs</var></a>.  The <var>exprs</var> should produce side effect(s) since nothing is printed or returned by the command itself.

</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="load">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">load</span>  <var class="arg">file</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval" colspan="2">&rarr; void</td></tr>
</table>
<blockquote>

<p> Loads a Lisp <var>file</var> (or a Lisp/SAL  <var>file</var> in the case of the SAL command.)
</p>

</blockquote>
<!-- END DEFINITION -->


<h3 id="sal_reserved">SAL Reserved Symbols</h3>

<table width="66%">
<tr>
<td>
<table>
<tr><td> <a href="#begin"><code>begin</code></a> </td></tr>
<tr><td> <a href="#loop"><code>below</code></a> </td></tr>
<tr><td> <a href="#loop"><code>by</code></a> </td></tr>
<tr><td> <a href="#chdir"><code>chdir</code></a> </td></tr>
<tr><td> <a href="#define"><code>define</code></a> </td></tr>
<tr><td> <a href="#if"><code>else</code></a> </td></tr>
<tr><td> <a href="#exec"><code>exec</code></a> </td></tr>
<tr><td> <a href="#begin"><code>end</code></a> </td></tr>
</table>
</td>
<td>
<table>
<tr><td>  <a href="#loop"><code>finally</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>for</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>from</code></a> </td></tr>
<tr><td>  <a href="#define_function"><code>function</code></a> </td></tr>
<tr><td>  <a href="#if"><code>if</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>in</code></a> </td></tr>
<tr><td>  <a href="#load"><code>load</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>loop</code></a> </td></tr>
</table>
</td>

<td>
<table>
<tr><td>  <a href="#run"><code>over</code></a> </td></tr>
<tr><td>  <a href="#print"><code>print</code></a> </td></tr>
<tr><td>  <a href="#define_process"><code>process</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>repeat</code></a> </td></tr>
<tr><td>  <a href="#return"><code>return</code></a> </td></tr>
<tr><td>  <a href="#run"><code>run</code></a> </td></tr>
<tr><td>  <a href="#send"><code>send</code></a> </td></tr>
<tr><td>  <a href="#then"><code>then</code></a> </td></tr>
</table>
</td>

<td>
<table>
<tr><td>  <a href="#loop"><code>to</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>unless</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>until</code></a> </td></tr>
<tr><td>  <a href="#define_variable"><code>variable</code></a> </td></tr>
<tr><td>  <a href="#wait"><code>wait</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>when</code></a> </td></tr>
<tr><td>  <a href="#loop"><code>while</code></a> </td></tr>
<tr><td>  <a href="#with"><code>with</code></a> </td></tr>
</table>
</td>

</tr>
</table>


<!-- EXAMPLES -->

<h3 id="sal_scheme_cltl">Table of SAL, Scheme and Common Lisp</h3>

<table>
  <caption>Translation table for SAL, Scheme and Common Lisp entities.
</caption>
  <thead>
  <tr>
    <th> </th>
    <th class="headingth">
      SAL
    </th>
    <th class="headingth" >

      Scheme <a href="#foot1"><span class="footnoteref">1</span></a>
    </th>
    <th class="headingth" >
      Common Lisp <a href="#foot2"><span class="footnoteref">2</span></a>
    </th>
  </tr>
  </thead>

  <tbody>

  <!-- Booleans -->
  <tr>    
    <th class="headingth">Booleans</th>
    <td class="saltd">
      #f
    </td>
    <td class="schemetd">

      #f
    </td>
    <td class="cltltd">
      nil
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      #t
    </td>

    <td class="schemetd">
      #t
    </td>
    <td class="cltltd">
      t
    </td>
  </tr>

  <!-- Keywords -->
  <tr>    
    <th class="headingth">Keywords</th>

    <td class="saltd">
      foobar:
    </td>
    <td class="schemetd">
      #:foobar <var>or</var> foobar:
    </td>
    <td class="cltltd">
      :foobar
    </td>
  </tr>

  <!-- Empty List -->
  <tr>    
    <th class="headingth">Lists</th>
    <td class="saltd">
      {}
    </td>
    <td class="schemetd">
      '()
    </td>

    <td class="cltltd">
      ()  <var>or</var> nil
    </td>
  </tr>

  <!-- Constant Lists -->
  <tr>    
    <th class="headingth"> </th>

    <td class="saltd">
      {a b {1 2 3} c}
    </td>
    <td class="schemetd">
      '(a b (1 2 3) e)
    </td>
    <td class="cltltd">
      '(a b (1 2 3) e)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>

    <td class="saltd">
      {a #$ ran(100) c}
    </td>
    <td class="schemetd">
      `(a ,(random 100) c}
    </td>
    <td class="cltltd">
      `(a ,(random 100) c)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>

    <td class="saltd">
      {a #^ list(ran(100), ran(100)) c}
    </td>
    <td class="schemetd">
      `(a ,@ (list (random 100) (random 100)) c}
    </td>
    <td class="cltltd">
      `(a ,@(list (random 100) (random 100)) c)
    </td>
  </tr>

  
    <!-- Constant Lists -->
  <tr>    
    <th class="headingth">Arithmetic</th>
    <td class="saltd">
      1 + 2
    </td>
    <td class="schemetd">
      (+ 1 2)
    </td>

    <td class="cltltd">
      (+ 1 2)
    </td>
  </tr>
  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      - 1
    </td>

    <td class="schemetd">
      (- 1)
    </td>
    <td class="cltltd">
      (- 1)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">

      1 + 2 + 3 * 4
    </td>
    <td class="schemetd">
      (+ 1 2 (* 3 4))
    </td>
    <td class="cltltd">
      (+ 1 2 (* 3 4))
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>

    <td class="saltd">
      3 ^ 4
    </td>
    <td class="schemetd">
      (expt 3 4)
    </td>
    <td class="cltltd">
      (expt 3 4)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      3 % 4
    </td>
    <td class="schemetd">
      (modulo 3 4)
    </td>
    <td class="cltltd">
      (mod 3 4)
    </td>

  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      a = b
    </td>
    <td class="schemetd">
      (= a b)
    </td>
    <td class="cltltd">

      (= a b)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      a / b != b * c
    </td>
    <td class="schemetd">
      (not (= (/ a b) (* b c)))
    </td>

    <td class="cltltd">
      (/= (/ a b) (* b c))
    </td>
  </tr>

    <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      a ~= b
    </td>
    <td class="schemetd">
      (equal a b)
    </td>

    <td class="cltltd">
      (equal a b)
    </td>
  </tr>

  <!-- Logic -->
  <tr>    
    <th class="headingth">Logic </th>
    <td class="saltd">
      a | b
    </td>

    <td class="schemetd">
      (or a b)
    </td>
    <td class="cltltd">
      (or a b)
    </td>
  </tr>
  <tr>
    <th class="headingth"> </th>

    <td class="saltd">
      ! a | b
    </td>
    <td class="schemetd">
      (or (not a) b)
    </td>
    <td class="cltltd">
      (or (not a) b)
    </td>
  </tr>

  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      a &amp; b | ! c
    </td>
    <td class="schemetd">
      (or (and a b) (not c))
    </td>
    <td class="cltltd">

      (or (and a b) (not c))
    </td>
  </tr>

  <tr>
    <th class="headingth"> Conditionals</th>
    <td class="saltd">
      if a = b then ... else ...
    </td>
    <td class="schemetd">

      (if (= a b) ... ...)
    </td>
    <td class="cltltd">
      (if (= a b) ... ...)
    </td>
  </tr>

  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      when a = b ...
    </td>
    <td class="schemetd">
     (when (= a b) ...)
    </td>
    <td class="cltltd">
     (when (= a b) ...)
    </td>
  </tr>
  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      unless a = b ...
    </td>
    <td class="schemetd">
     (unless (= a b) ...)
    </td>
    <td class="cltltd">
     (unless (= a b) ...)
    </td>
  </tr>
  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      #?(a = b, -99, 2)
    </td>
    <td class="schemetd">

      (if (= a b) -99 2)
    </td>
    <td class="cltltd">
      (if (= a b) -99 2)
    </td>
  </tr>


  <!-- Function calls -->
  <tr>    
    <th class="headingth">Function calls</th>

    <td class="saltd">
      list()
    </td>
    <td class="schemetd">
      (list)
    </td>
    <td class="cltltd">
      (list)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      list(10)
    </td>
    <td class="schemetd">
      (list 10)
    </td>
    <td class="cltltd">
      (list 10)
    </td>

  </tr>
  <tr>
    <th class="headingth"></th>
    <td class="saltd">
      list(1, 2 + 3, 4)
    </td>
    <td class="schemetd">
      (list 1 (+ 2 3) 4)
    </td>
    <td class="cltltd">

      (list 1 (+ 2 3) 4)
    </td>
  </tr>

  <tr>
    <th class="headingth"></th>
    <td class="saltd">
      list(1, 2, ran(10))
    </td>
    <td class="schemetd">

      (list 1 2 (random 10))
    </td>
    <td class="cltltd">
      (list 1 2 (random 10))
    </td>
  </tr>


  <!-- Global Variables -->
  <tr>    
    <th class="headingth">Global variables</th>

    <td class="saltd">
      define variable a
    </td>
    <td class="schemetd">
      (define a #f)
    </td>
    <td class="cltltd">
      (defparameter a nil)
    </td>
  </tr>

  <!-- Global Variables 2
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      define variable a = 123,<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b = a + 1
    </td>
    <td class="schemetd">

      (define a 123)<br/>
      (define b (+ a 1))
    </td>
    <td class="cltltd">
      (defparameter a 123)<br/>
      (defparameter b (+ a 1))
    </td>
  </tr>  -->

  <!-- Function Definitions -->

  <tr>    
    <th class="headingth">Function definitions </th>
    <td class="saltd">
      define function foo (a)<br/>
      &nbsp;&nbsp;return a + ran(10)

    </td>
    <td class="schemetd">

      (define (foo a)<br/>
      &nbsp;&nbsp;(+ a (random 10)))
    </td>
    <td class="cltltd">
      (defun foo (a)<br/>
      &nbsp;&nbsp;(+ a (random 10)))
    </td>
  </tr>

  <!-- Code blocks 1 -->
  <tr>    
    <th class="headingth">Code blocks</th>
    <td class="saltd">
      begin<br/>
      &nbsp;&nbsp;...<br/>
      end
    </td>

    <td class="schemetd">
      (begin<br/>
      &nbsp;&nbsp;...<br/>
      &nbsp;&nbsp;)
    </td>
    <td class="cltltd">
      (progn<br/>
      &nbsp;&nbsp;...<br/>

      &nbsp;&nbsp;)
    </td>
  </tr>


 <!-- Code blocks 2 -->

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      begin<br/>
      &nbsp;&nbsp;with a = 1, b = a + 2<br/>
      &nbsp;&nbsp;...<br/>
      end
    </td>

    <td class="schemetd">
      (let* ((a 1)<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b (+ a 2))<br/>
      &nbsp;&nbsp;...<br/>
      &nbsp;&nbsp;)
    </td>
    <td class="cltltd">
      (let* ((a 1)<br/>

      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b (+ a 2))<br/>
      &nbsp;&nbsp;...<br/>
      &nbsp;&nbsp;)
    </td>
  </tr>




  
  <!-- Assignment 1 -->
  <tr>    
    <th class="headingth"> Assignment</th>
    <td class="saltd">
      set a = 123
    </td>
    <td class="schemetd">
      (set! a 123)
    </td>

    <td class="cltltd">
      (setf a 123)
    </td>
  </tr>

  <!-- Assignment 2 -->
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a = 123, b = a
    </td>

    <td class="schemetd">
      (set! a 123)<br/>
      (set! b a)
    </td>
    <td class="cltltd">
      (setf a 123 b a)
    </td>
  </tr>

  <!-- Assignment 3 -->

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a += 123
    </td>
    <td class="schemetd">
      (set! a (+ a 123))
    </td>
    <td class="cltltd">
      (incf a 123)
    </td>

  </tr>

  <!-- Assignment 4 -->
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a *= 123
    </td>
    <td class="schemetd">
      (set! a (* a 123))
    </td>

    <td class="cltltd">
      (setf a (* a 123))
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a &amp;= 123
    </td>
    <td class="schemetd">
      (set! a (append a (list 123)))
    </td>

    <td class="cltltd">
      (setf a (append a (list 123)))
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a @= 123
    </td>
    <td class="schemetd">
      (set! a (cons 123 a))
    </td>

    <td class="cltltd">
      (push 123 a)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a &lt;= 123
    </td>
    <td class="schemetd">
      (set! a (min 123 a))
    </td>

    <td class="cltltd">
      (setf a (min 123 a))
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a &gt;= 123
    </td>
    <td class="schemetd">
      (set! a (max 123 a))
    </td>

    <td class="cltltd">
      (setf a (max 123 a))
    </td>
  </tr>


  <!-- Iteration -->
  <tr>    
    <th class="headingth">Iteration </th>
    <td class="saltd">
      loop ... end
    </td>
    <td class="schemetd">
      (loop ...)
    </td>

    <td class="cltltd">
      (loop ... )
    </td>
  </tr>

  


  <!--  TABLE FOOTER -->



  <tr>
    <td> </td>
    <td colspan="3" id="foot1">1. Reference Scheme implementation: <a href="http://www.call-with-current-continuation.org/">Chicken Scheme</a>
    </td>
  </tr>

  <tr>
    <td> </td>
    <td colspan="3" id="foot2">2. Reference Common Lisp: <a href="http:sbcl.sourceforge.net">Steel Bank Common Lisp (SBCL)</a>
    </td>
  </tr>

  </tbody>

</table>    







<!-- 
<h2 id="xml">XML Description</h2>

<p>Plotter saves, loads, imports and exports data using
XML entities defined in the DTD file "grace/doc/grace.dtd". </p>

<p>Users can define their own Plotter points by declaring the
point using the XML <code>&lt;<span
class="xmlentity">pointdef</span>&gt;</code> ... <code>&lt;<span
class="xmlentity">/pointdef</span>&gt;</code> entity.  Here is the
definition of Plotter's (predefined) xy point: </p>

<pre>
&lt;<span class="xmlentity">pointdef</span>&gt;
  &lt;<span class="xmlentity">name</span>&gt;xy&lt;<span class="xmlentity">/name</span>&gt;
  &lt;<span class="xmlentity">fieldlist</span>&gt;
    &lt;<span class="xmlentity">field</span>&gt; &lt;<span class="xmlentity">name</span>&gt;x&lt;<span class="xmlentity">/name</span>&gt; &lt;<span class="xmlentity">type</span>&gt;float 0 1&lt;<span class="xmlentity">/type</span>&gt; &lt;<span class="xmlentity">default</span>&gt;0&lt;<span class="xmlentity">/default</span>&gt; &lt;<span class="xmlentity">/field</span>&gt;
    &lt;<span class="xmlentity">field</span>&gt; &lt;<span class="xmlentity">name</span>&gt;y&lt;<span class="xmlentity">/name</span>&gt; &lt;<span class="xmlentity">type</span>&gt;float 0 1&lt;<span class="xmlentity">/type</span>&gt; &lt;<span class="xmlentity">default</span>&gt;0&lt;<span class="xmlentity">/default</span>&gt; &lt;<span class="xmlentity">/field</span>&gt;
  &lt;<span class="xmlentity">/fieldlist</span>&gt;
&lt;<span class="xmlentity">/pointdef</span>&gt;
</pre>


<p>Point definitions can be converted to sound by providing a <code>
&lt;<span class="xmlentity">soundmap</span>&gt; ... &lt;<span
class="xmlentity">/soundmap</span>&gt; </code> entity that describes
how to transform the point's field values into data sent to a
port. For example, this description would convert an xy point into a
Midi Port note by converting point's <var>x</var> field to a time value
between 0 and 10, the <var>y</var> field to a key number between 60 72, and
constant values for duration (.5) amplitude (.25) and channel (0):</p>

<pre>
&lt;<span class="xmlentity">soundmap</span>&gt;
  &lt;<span class="xmlentity">mp:midi </span>&gt;
    &lt;<span class="xmlentity">mp:time</span>&gt; &lt;<span class="xmlentity">source</span>&gt;x&lt;<span class="xmlentity">/source</span>&gt; &lt;<span class="xmlentity">scaler</span>&gt;10&lt;<span class="xmlentity">/scaler</span>&gt; &lt;<span class="xmlentity">/mp:time</span>&gt;
    &lt;<span class="xmlentity">mp:dur</span>&gt; &lt;<span class="xmlentity">source</span>&gt;.5&lt;<span class="xmlentity">/source</span>&gt; &lt;<span class="xmlentity">/mp:dur</span>&gt;
    &lt;<span class="xmlentity">mp:key</span>&gt; &lt;<span class="xmlentity">source</span>&gt;y&lt;<span class="xmlentity">/source</span>&gt; &lt;<span class="xmlentity">scaler</span>&gt;12&lt;<span class="xmlentity">/scaler</span>&gt; &lt;<span class="xmlentity">offset</span>&gt;60&lt;<span class="xmlentity">/offset</span>&gt; &lt;<span class="xmlentity">/mp:key</span>&gt;
    &lt;<span class="xmlentity">mp:amp</span>&gt; &lt;<span class="xmlentity">source</span>&gt;.25&lt;<span class="xmlentity">/source</span>&gt; &lt;<span class="xmlentity">scaler</span>&gt;127&lt;<span class="xmlentity">/scaler</span>&gt; &lt;<span class="xmlentity">/mp:amp</span>&gt;
    &lt;<span class="xmlentity">mp:chan</span>&gt; &lt;<span class="xmlentity">source</span>&gt;0&lt;<span class="xmlentity">/source</span>&gt; &lt;<span class="xmlentity">/mp:chan</span>&gt;
  &lt;<span class="xmlentity">/mp:midi</span>&gt;
&lt;<span class="xmlentity">/soundmap</span>&gt;
</pre>


<p>User defined XML descriptions are saved in the
Grace.prefs file:
</p>

-->

</div>

<hr/>

<p>
<a href="http://validator.w3.org/check?uri=referer"><img
src="http://www.w3.org/Icons/valid-xhtml10-blue"
alt="Valid XHTML 1.0 Strict" height="31" width="88" /></a>
</p>

</body>
</html>

